<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Overview of Modeling Approaches for Causal Mediation Analysis • CMAverse</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/sandstone/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Overview of Modeling Approaches for Causal Mediation Analysis">
<meta property="og:description" content="CMAverse">
<meta property="og:image" content="https://Jun1422.github.io/test_repo/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">CMAverse</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home"></span>
     
  </a>
</li>
<li>
  <a href="../articles/overview.html">Overview of Modeling Approaches</a>
</li>
<li>
  <a href="../articles/quickstart.html">Quickstart</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Examples
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/single_mediator.html">Statistical Modeling with a Single Mediator</a>
    </li>
    <li>
      <a href="../articles/multiple_mediators.html">Statistical Modeling with Multiple Mediators</a>
    </li>
    <li>
      <a href="../articles/case_control.html">Statistical Modeling for a Case Control Study</a>
    </li>
    <li>
      <a href="../articles/multiple_imputation.html">Statistical Modeling with Missing Data</a>
    </li>
    <li>
      <a href="../articles/post_exposure_confounding.html">Statistical Modeling with Post-exposure Confounding</a>
    </li>
    <li>
      <a href="../articles/measurement_error.html">Sensitivity Analysis for Measurement Error</a>
    </li>
    <li>
      <a href="../articles/multistate_model.html">Statistical Modeling with a Time-to-event Mediator</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="../reference/index.html">
    <span class="fa fa-file-code-o"></span>
     
    Functions
  </a>
</li>
<li>
  <a href="https://Jun1422.github.io/test_repo/">
    <span class="fa fa-github fa-lg"></span>
     
    GitHub
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="overview_files/header-attrs-2.9/header-attrs.js"></script><script src="overview_files/kePrint-0.0.1/kePrint.js"></script><link href="overview_files/lightable-0.0.1/lightable.css" rel="stylesheet">
<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Overview of Modeling Approaches for Causal Mediation Analysis</h1>
            
            <h4 class="date">2022-03-24</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/BS1125/CMAverse/blob/master/vignettes/overview.Rmd"><code>vignettes/overview.Rmd</code></a></small>
      <div class="hidden name"><code>overview.Rmd</code></div>

    </div>

    
    
<p>This document describes how the seven causal mediation analysis approaches including <em>the regression-based approach</em> by <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC3659198/">Valeri et al. (2013)</a> and <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC4287269/">VanderWeele et al. (2014)</a>, <em>the weighting-based approach</em> by <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC4287269/">VanderWeele et al. (2014)</a>, <em>the inverse odd-ratio weighting approach</em> by <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC3954805/">Tchetgen Tchetgen (2013)</a>, <em>the natural effect model</em> by <a href="https://www.degruyter.com/view/journals/em/1/1/article-p131.xml?language=en">Vansteelandt et al. (2012)</a>, <em>the marginal structural model</em> by <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC5560424/">VanderWeele et al. (2017)</a>, <em>the <span class="math inline">\(g\)</span>-formula approach</em> by <a href="https://www.sciencedirect.com/science/article/pii/0270025586900886">Robins (1986)</a>, and <em>The multistate approach for stochastic interventions on a time-to event mediator in the presence of semi-competing risks</em> by <a href="https://arxiv.org/abs/2102.13252">Valeri et al. (2021)</a> are implemented by the <code>CMAverse</code> package. See publications of these approaches for methodological details .</p>
<p><code>CMAverse</code> currently supports a single exposure, multiple sequential mediators and a single outcome. When multiple mediators are of interest, <code>CMAverse</code> estimates the joint mediated effect through the set of mediators. <code>CMAverse</code> also supports time varying confounders preceding the mediators.</p>
<p>We categorize the causal mediation analysis approaches based on whether the approach can deal with mediator-outcome confounders affected by the exposure. Among the seven approaches, only <em>The marginal structural model</em> and <em>the <span class="math inline">\(g\)</span>-formula approach</em> are able to deal with mediator-outcome confounders affected by the exposure.</p>
<p>In this document, the outcome and the exposure are denoted as <span class="math inline">\(Y\)</span> and <span class="math inline">\(A\)</span> respectively. The set of exposure-mediator confounders, exposure-outcome confounders and mediator-outcome confounders not affected by the exposure is denoted as <span class="math inline">\(C\)</span>. The set of mediators is denoted as <span class="math inline">\(M\)</span> and <span class="math inline">\(M=(M_1,...,M_k)\)</span> follows the temporal order. The set of mediator-outcome confounders affected by the exposure is denoted as <span class="math inline">\(L\)</span> and <span class="math inline">\(L=(L_1,...,L_s)\)</span> follows the temporal order.</p>
<p>Since weights calculated from noncategorical variables are unstable, which hurts the performance of effect estimation and inference, weighted approaches can be implemented only for categorical exposure and mediator(s).</p>
<div id="no-confounders-affected-by-the-exposure" class="section level1">
<h1 class="hasAnchor">
<a href="#no-confounders-affected-by-the-exposure" class="anchor"></a>No Confounders Affected by the Exposure</h1>
<div id="dag" class="section level2">
<h2 class="hasAnchor">
<a href="#dag" class="anchor"></a>DAG</h2>
<p><img src="overview_files/figure-html/unnamed-chunk-2-1.png" width="576"></p>
</div>
<div id="estimands" class="section level2">
<h2 class="hasAnchor">
<a href="#estimands" class="anchor"></a>Estimands</h2>
<p>For a continuous outcome or survival outcome with a time-to-event mediator, causal effects are estimated on the difference scale (summarized in table 1). For a categorical, count, or survival outcome, causal effects are estimated on the ratio scale (summarized in table 2). See <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC3659198/">Valeri et al. (2013)</a> and <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC4220271/">VanderWeele (2015)</a> for details about these effects.</p>
<table class="table table table-bordered table-striped table-hover table-responsive table-condensed">
<caption>
Table 1: Causal Effects on the Difference Scale
</caption>
<thead><tr>
<th style="text-align:left;">
Full Name
</th>
<th style="text-align:left;">
Abbreviation
</th>
<th style="text-align:left;">
Formula
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;width: 20em; ">
Controlled Direct Effect
</td>
<td style="text-align:left;width: 8em; ">
<span class="math inline">\(CDE\)</span>
</td>
<td style="text-align:left;width: 10em; ">
<span class="math inline">\(E[Y_{am}-Y_{a^*m}]\)</span>
</td>
</tr>
<tr>
<td style="text-align:left;width: 20em; ">
Pure Natural Direct Effect
</td>
<td style="text-align:left;width: 8em; ">
<span class="math inline">\(PNDE\)</span>
</td>
<td style="text-align:left;width: 10em; ">
<span class="math inline">\(E[Y_{aM_a^*}-Y_{a^*M_a^*}]\)</span>
</td>
</tr>
<tr>
<td style="text-align:left;width: 20em; ">
Total Natural Direct Effect
</td>
<td style="text-align:left;width: 8em; ">
<span class="math inline">\(TNDE\)</span>
</td>
<td style="text-align:left;width: 10em; ">
<span class="math inline">\(E[Y_{aM_a}-Y_{a^*M_a}]\)</span>
</td>
</tr>
<tr>
<td style="text-align:left;width: 20em; ">
Pure Natural Indirect Effect
</td>
<td style="text-align:left;width: 8em; ">
<span class="math inline">\(PNIE\)</span>
</td>
<td style="text-align:left;width: 10em; ">
<span class="math inline">\(E[Y_{a^*M_a}-Y_{a^*M_a^*}]\)</span>
</td>
</tr>
<tr>
<td style="text-align:left;width: 20em; ">
Total Natural Indirect Effect
</td>
<td style="text-align:left;width: 8em; ">
<span class="math inline">\(TNIE\)</span>
</td>
<td style="text-align:left;width: 10em; ">
<span class="math inline">\(E[Y_{aM_a}-Y_{aM_a^*}]\)</span>
</td>
</tr>
<tr>
<td style="text-align:left;width: 20em; ">
Residual Disparity
</td>
<td style="text-align:left;width: 8em; ">
<span class="math inline">\(RD\)</span>
</td>
<td style="text-align:left;width: 10em; ">
<span class="math inline">\(P(S_g\)</span>&gt;<span class="math inline">\(s|a,c)-P(S_{g}\)</span>&gt;<span class="math inline">\(s|a^{*},c)\)</span>
</td>
</tr>
<tr>
<td style="text-align:left;width: 20em; ">
Shifting Distribution Effect
</td>
<td style="text-align:left;width: 8em; ">
<span class="math inline">\(SDE\)</span>
</td>
<td style="text-align:left;width: 10em; ">
<span class="math inline">\(P(S_{g}\)</span>&gt;<span class="math inline">\(s|a,c)-P(S_{g^*}\)</span>&gt;<span class="math inline">\(s|a,c)\)</span>
</td>
</tr>
<tr>
<td style="text-align:left;width: 20em; ">
Total Effect
</td>
<td style="text-align:left;width: 8em; ">
<span class="math inline">\(TE\)</span>
</td>
<td style="text-align:left;width: 10em; ">
<span class="math inline">\(PNDE+TNIE\)</span> or <span class="math inline">\(TNDE+PNIE\)</span> or <span class="math inline">\(RD+SD\)</span>
</td>
</tr>
<tr>
<td style="text-align:left;width: 20em; ">
Reference Interaction
</td>
<td style="text-align:left;width: 8em; ">
<span class="math inline">\(INT_{ref}\)</span>
</td>
<td style="text-align:left;width: 10em; ">
<span class="math inline">\(PNDE-CDE\)</span>
</td>
</tr>
<tr>
<td style="text-align:left;width: 20em; ">
Mediated Interaction
</td>
<td style="text-align:left;width: 8em; ">
<span class="math inline">\(INT_{med}\)</span>
</td>
<td style="text-align:left;width: 10em; ">
<span class="math inline">\(TNIE-PNIE\)</span>
</td>
</tr>
<tr>
<td style="text-align:left;width: 20em; ">
Proportion <span class="math inline">\(CDE\)</span>
</td>
<td style="text-align:left;width: 8em; ">
<span class="math inline">\(prop^{CDE}\)</span>
</td>
<td style="text-align:left;width: 10em; ">
<span class="math inline">\(CDE/TE\)</span>
</td>
</tr>
<tr>
<td style="text-align:left;width: 20em; ">
Proportion <span class="math inline">\(INT_{ref}\)</span>
</td>
<td style="text-align:left;width: 8em; ">
<span class="math inline">\(prop^{INT_{ref}}\)</span>
</td>
<td style="text-align:left;width: 10em; ">
<span class="math inline">\(INT_{ref}/TE\)</span>
</td>
</tr>
<tr>
<td style="text-align:left;width: 20em; ">
Proportion <span class="math inline">\(INT_{med}\)</span>
</td>
<td style="text-align:left;width: 8em; ">
<span class="math inline">\(prop^{INT_{med}}\)</span>
</td>
<td style="text-align:left;width: 10em; ">
<span class="math inline">\(INT_{med}/TE\)</span>
</td>
</tr>
<tr>
<td style="text-align:left;width: 20em; ">
Proportion <span class="math inline">\(PNIE\)</span>
</td>
<td style="text-align:left;width: 8em; ">
<span class="math inline">\(prop^{PNIE}\)</span>
</td>
<td style="text-align:left;width: 10em; ">
<span class="math inline">\(PNIE/TE\)</span>
</td>
</tr>
<tr>
<td style="text-align:left;width: 20em; ">
Proportion Mediated
</td>
<td style="text-align:left;width: 8em; ">
<span class="math inline">\(PM\)</span>
</td>
<td style="text-align:left;width: 10em; ">
<span class="math inline">\(TNIE/TE\)</span>
</td>
</tr>
<tr>
<td style="text-align:left;width: 20em; ">
Proportion Attributable to Interaction
</td>
<td style="text-align:left;width: 8em; ">
<span class="math inline">\(INT\)</span>
</td>
<td style="text-align:left;width: 10em; ">
<span class="math inline">\((INT_{ref}+INT_{med})/TE\)</span>
</td>
</tr>
<tr>
<td style="text-align:left;width: 20em; ">
Proportion Eliminated
</td>
<td style="text-align:left;width: 8em; ">
<span class="math inline">\(PE\)</span>
</td>
<td style="text-align:left;width: 10em; ">
<span class="math inline">\((INT_{ref}+INT_{med}+PNIE)/TE\)</span>
</td>
</tr>
</tbody>
<tfoot>
<tr>
<td style="padding: 0; " colspan="100%">
<span style="font-style: italic;">Note: </span>
</td>
</tr>
<tr>
<td style="padding: 0; " colspan="100%">
<sup></sup><span class="math inline">\(a\)</span> and <span class="math inline">\(a^*\)</span> are the active and control values for <span class="math inline">\(A\)</span> respectively. <span class="math inline">\(m\)</span> is the value at which <span class="math inline">\(M\)</span> is controlled. <span class="math inline">\(M_a\)</span> denotes the counterfactual value of <span class="math inline">\(M\)</span> that would have been observed had <span class="math inline">\(A\)</span> been set to be <span class="math inline">\(a\)</span>. <span class="math inline">\(Y_{am}\)</span> denotes the counterfactual value of <span class="math inline">\(Y\)</span> that would have been observed had <span class="math inline">\(A\)</span> been set to be <span class="math inline">\(a\)</span>, and <span class="math inline">\(M\)</span> to be <span class="math inline">\(m\)</span>. <span class="math inline">\(Y_{aMa*}\)</span> denotes the counterfactual value of <span class="math inline">\(Y\)</span> that would have been observed had <span class="math inline">\(A\)</span> been set to be <span class="math inline">\(a\)</span>, and <span class="math inline">\(M\)</span> to be the counterfactual value <span class="math inline">\(M_{a*}\)</span>. <span class="math inline">\(g\)</span> is the random draw from the time to mediator distribution observed among individuals without exposure. <span class="math inline">\(g^*\)</span> is the random draw from the time to mediator distribution observed among individuals with exposure.
</td>
</tr>
</tfoot>
</table>
<table class="table table table-bordered table-striped table-hover table-responsive">
<caption>
Table 2: Causal Effects on the Ratio Scale
</caption>
<thead><tr>
<th style="text-align:left;">
Full Name
</th>
<th style="text-align:left;">
Abbreviation
</th>
<th style="text-align:left;">
Formula
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;width: 20em; ">
Controlled Direct Effect
</td>
<td style="text-align:left;width: 8em; ">
<span class="math inline">\(R^{CDE}\)</span>
</td>
<td style="text-align:left;width: 10em; ">
<span class="math inline">\(E[Y_{am}]/E[Y_{a^*m}]\)</span>
</td>
</tr>
<tr>
<td style="text-align:left;width: 20em; ">
Pure Natural Direct Effect
</td>
<td style="text-align:left;width: 8em; ">
<span class="math inline">\(R^{PNDE}\)</span>
</td>
<td style="text-align:left;width: 10em; ">
<span class="math inline">\(E[Y_{aM_a^*}]/E[Y_{a^*M_a^*}]\)</span>
</td>
</tr>
<tr>
<td style="text-align:left;width: 20em; ">
Total Natural Direct Effect
</td>
<td style="text-align:left;width: 8em; ">
<span class="math inline">\(R^{TNDE}\)</span>
</td>
<td style="text-align:left;width: 10em; ">
<span class="math inline">\(E[Y_{aM_a}]/E[Y_{a^*M_a}]\)</span>
</td>
</tr>
<tr>
<td style="text-align:left;width: 20em; ">
Pure Natural Indirect Effect
</td>
<td style="text-align:left;width: 8em; ">
<span class="math inline">\(R^{PNIE}\)</span>
</td>
<td style="text-align:left;width: 10em; ">
<span class="math inline">\(E[Y_{a^*M_a}]/E[Y_{a^*M_a^*}]\)</span>
</td>
</tr>
<tr>
<td style="text-align:left;width: 20em; ">
Total Natural Indirect Effect
</td>
<td style="text-align:left;width: 8em; ">
<span class="math inline">\(R^{TNIE}\)</span>
</td>
<td style="text-align:left;width: 10em; ">
<span class="math inline">\(E[Y_{aM_a}]/E[Y_{aM_a^*}]\)</span>
</td>
</tr>
<tr>
<td style="text-align:left;width: 20em; ">
Total Effect
</td>
<td style="text-align:left;width: 8em; ">
<span class="math inline">\(R^{TE}\)</span>
</td>
<td style="text-align:left;width: 10em; ">
<span class="math inline">\(R^{PNDE}\times R^{TNIE}\)</span> or <span class="math inline">\(R^{TNDE}\times R^{PNIE}\)</span>
</td>
</tr>
<tr>
<td style="text-align:left;width: 20em; ">
Excess Ratio due to Controlled Direct Effect
</td>
<td style="text-align:left;width: 8em; ">
<span class="math inline">\(ER^{CDE}\)</span>
</td>
<td style="text-align:left;width: 10em; ">
<span class="math inline">\((E[Y_{am}-Y_{a^*m}])/E[Y_{a^*M_a^*}]\)</span>
</td>
</tr>
<tr>
<td style="text-align:left;width: 20em; ">
Excess Ratio due to Reference Interaction
</td>
<td style="text-align:left;width: 8em; ">
<span class="math inline">\(ER^{INT_{ref}}\)</span>
</td>
<td style="text-align:left;width: 10em; ">
<span class="math inline">\(R^{PNDE}-1-ER^{CDE}\)</span>
</td>
</tr>
<tr>
<td style="text-align:left;width: 20em; ">
Excess Ratio due to Mediated Interaction
</td>
<td style="text-align:left;width: 8em; ">
<span class="math inline">\(ER^{INT_{med}}\)</span>
</td>
<td style="text-align:left;width: 10em; ">
<span class="math inline">\(R^{TNIE}*R^{PNDE}-R^{PNDE}-R^{PNIE}+1\)</span>
</td>
</tr>
<tr>
<td style="text-align:left;width: 20em; ">
Excess Ratio due to Pure Natural Indirect Effect
</td>
<td style="text-align:left;width: 8em; ">
<span class="math inline">\(ER^{PNIE}\)</span>
</td>
<td style="text-align:left;width: 10em; ">
<span class="math inline">\(R^{PNIE}-1\)</span>
</td>
</tr>
<tr>
<td style="text-align:left;width: 20em; ">
Proportion <span class="math inline">\(ER^{CDE}\)</span>
</td>
<td style="text-align:left;width: 8em; ">
<span class="math inline">\(prop^{ER^{CDE}}\)</span>
</td>
<td style="text-align:left;width: 10em; ">
<span class="math inline">\(ER^{CDE}/(R^{TE}-1)\)</span>
</td>
</tr>
<tr>
<td style="text-align:left;width: 20em; ">
Proportion <span class="math inline">\(ER^{INT_{ref}}\)</span>
</td>
<td style="text-align:left;width: 8em; ">
<span class="math inline">\(prop^{ER^{INT_{ref}}}\)</span>
</td>
<td style="text-align:left;width: 10em; ">
<span class="math inline">\(ER^{INT_{ref}}/(R^{TE}-1)\)</span>
</td>
</tr>
<tr>
<td style="text-align:left;width: 20em; ">
Proportion <span class="math inline">\(ER^{INT_{med}}\)</span>
</td>
<td style="text-align:left;width: 8em; ">
<span class="math inline">\(prop^{ER^{INT_{med}}}\)</span>
</td>
<td style="text-align:left;width: 10em; ">
<span class="math inline">\(ER^{INT_{med}}/(R^{TE}-1)\)</span>
</td>
</tr>
<tr>
<td style="text-align:left;width: 20em; ">
Proportion <span class="math inline">\(ER^{PNIE}\)</span>
</td>
<td style="text-align:left;width: 8em; ">
<span class="math inline">\(prop^{ER^{PNIE}}\)</span>
</td>
<td style="text-align:left;width: 10em; ">
<span class="math inline">\(ER^{PNIE}/(R^{TE}-1)\)</span>
</td>
</tr>
<tr>
<td style="text-align:left;width: 20em; ">
Proportion Mediated
</td>
<td style="text-align:left;width: 8em; ">
<span class="math inline">\(PM\)</span>
</td>
<td style="text-align:left;width: 10em; ">
<span class="math inline">\((R^{PNDE}*(R^{TNIE}-1))/(R^{TE}-1)\)</span>
</td>
</tr>
<tr>
<td style="text-align:left;width: 20em; ">
Proportion Attributable to Interaction
</td>
<td style="text-align:left;width: 8em; ">
<span class="math inline">\(INT\)</span>
</td>
<td style="text-align:left;width: 10em; ">
<span class="math inline">\((ER^{INT_{ref}}+ER^{INT_{med}})/(R^{TE}-1)\)</span>
</td>
</tr>
<tr>
<td style="text-align:left;width: 20em; ">
Proportion Eliminated
</td>
<td style="text-align:left;width: 8em; ">
<span class="math inline">\(PE\)</span>
</td>
<td style="text-align:left;width: 10em; ">
<span class="math inline">\((ER^{INT_{ref}}+ER^{INT_{med}}+ER^{PNIE})/(R^{TE}-1)\)</span>
</td>
</tr>
</tbody>
<tfoot>
<tr>
<td style="padding: 0; " colspan="100%">
<span style="font-style: italic;">Note: </span>
</td>
</tr>
<tr>
<td style="padding: 0; " colspan="100%">
<sup></sup><span class="math inline">\(a\)</span> and <span class="math inline">\(a^*\)</span> are the active and control values for <span class="math inline">\(A\)</span> respectively. <span class="math inline">\(m\)</span> is the value at which <span class="math inline">\(M\)</span> is controlled. <span class="math inline">\(M_a\)</span> denotes the counterfactual value of <span class="math inline">\(M\)</span> that would have been observed had <span class="math inline">\(A\)</span> been set to be <span class="math inline">\(a\)</span>. <span class="math inline">\(Y_{am}\)</span> denotes the counterfactual value of <span class="math inline">\(Y\)</span> that would have been observed had <span class="math inline">\(A\)</span> been set to be <span class="math inline">\(a\)</span>, and <span class="math inline">\(M\)</span> to be <span class="math inline">\(m\)</span>. <span class="math inline">\(Y_{aMa*}\)</span> denotes the counterfactual value of <span class="math inline">\(Y\)</span> that would have been observed had <span class="math inline">\(A\)</span> been set to be <span class="math inline">\(a\)</span>, and <span class="math inline">\(M\)</span> to be the counterfactual value <span class="math inline">\(M_{a*}\)</span>. If <span class="math inline">\(Y\)</span> is categorical, <span class="math inline">\(E[Y]\)</span> represents the probability of <span class="math inline">\(Y=y\)</span> where <span class="math inline">\(y\)</span> is a pre-specified value of <span class="math inline">\(Y\)</span>.
</td>
</tr>
</tfoot>
</table>
</div>
<div id="the-regression-based-approach" class="section level2">
<h2 class="hasAnchor">
<a href="#the-regression-based-approach" class="anchor"></a>The Regression-based Approach</h2>
<p>With the regression-based approach, all causal effects are estimated through either closed-form parameter function estimation or direct counterfactual imputation estimation. Standard errors of causal effects are estimated through either the delta method or bootstrapping.</p>
<div id="closed-form-parameter-function-estimation" class="section level3">
<h3 class="hasAnchor">
<a href="#closed-form-parameter-function-estimation" class="anchor"></a>Closed-form Parameter Function Estimation</h3>
<p>Closed-form parameter function estimation is available when there is only a single mediator, i.e., <span class="math inline">\(M=M_1\)</span>. Also, <code>yreg</code> must be chosen from <code>linear</code>, <code>logistic</code>, <code>loglinear</code>, <code>poisson</code>, <code>quasipoisson</code>, <code>negbin</code>, <code>coxph</code>, <code>aft_exp</code> and <code>aft_weibull</code>. <code>mreg</code> must be chosen from <code>linear</code>, <code>logistic</code> and <code>multinomial</code>. To use <code>yreg = "logistic"</code> and <code>yreg = "coxph"</code> in closed-form parameter function estimation, the outcome must be rare. Additionally, the causal effects estimated through closed-form parameter function estimation are conditional on the value of <span class="math inline">\(C\)</span> specified by the <code>precval</code> argument. Closed-form parameter functions are summarized below.</p>
<div id="linear-yreg-linear-mreg-and-noncategorical-exposure" class="section level4">
<h4 class="hasAnchor">
<a href="#linear-yreg-linear-mreg-and-noncategorical-exposure" class="anchor"></a>Linear <code>yreg</code>, Linear <code>mreg</code> and Noncategorical Exposure</h4>
<p>If the exposure is not categorical, <code>yreg="linear"</code> and <code>mreg=list("linear")</code>, <code>CMAverse</code> estimates the causal effects by the following steps:</p>
<ol style="list-style-type: decimal">
<li><p>Fit a linear regression model for the mediator: <span class="math display">\[E[M|A,C]=\beta_0+\beta_1A+\beta_2'C\]</span></p></li>
<li><p>Fit a linear regression model for the outcome: <span class="math display">\[E[Y|A,M,C]=\theta_0+\theta_1A+\theta_2M+\theta_3AM+\theta_4'C\]</span></p></li>
<li>
<p>Estimate <span class="math inline">\(CDE\)</span>, <span class="math inline">\(PNDE\)</span>, <span class="math inline">\(TNDE\)</span>, <span class="math inline">\(PNIE\)</span> and <span class="math inline">\(TNIE\)</span> by the following parameter functions:</p>
<ul>
<li><span class="math inline">\(CDE=(\theta_1+\theta_3m)(a-a^*)\)</span></li>
<li><span class="math inline">\(PNDE=\{\theta_1+\theta_3(\beta_0+\beta_1a^*+\beta_2'c)\}(a-a^*)\)</span></li>
<li><span class="math inline">\(TNDE=\{\theta_1+\theta_3(\beta_0+\beta_1a+\beta_2'c)\}(a-a^*)\)</span></li>
<li><span class="math inline">\(PNIE=(\theta_2\beta_1+\theta_3\beta_1a^*)(a-a^*)\)</span></li>
<li><span class="math inline">\(TNIE=(\theta_2\beta_1+\theta_3\beta_1a)(a-a^*)\)</span></li>
</ul>
</li>
<li><p>Calculate other effects using formulas in table 1.</p></li>
</ol>
</div>
<div id="linear-yreg-linear-mreg-and-categorical-exposure" class="section level4">
<h4 class="hasAnchor">
<a href="#linear-yreg-linear-mreg-and-categorical-exposure" class="anchor"></a>Linear <code>yreg</code>, Linear <code>mreg</code> and Categorical Exposure</h4>
<p>If the exposure is categorical, <code>yreg="linear"</code> and <code>mreg=list("linear")</code>, <code>CMAverse</code> estimates the causal effects by the following steps:</p>
<ol style="list-style-type: decimal">
<li><p>Fit a linear regression model for the mediator: <span class="math display">\[E[M|A,C]=\beta_0+\sum_{h=1}^H\beta_{1h}I\{A=h\}+\beta_2'C\]</span></p></li>
<li><p>Fit a linear regression model for the outcome: <span class="math display">\[E[Y|A,M,C]=\theta_0+\sum_{h=1}^H\theta_{1h}I\{A=h\}+\theta_2M+\sum_{h=1}^H\theta_{3h}I\{A=h\}M+\theta_4'C\]</span></p></li>
<li>
<p>Estimate <span class="math inline">\(CDE\)</span>, <span class="math inline">\(PNDE\)</span>, <span class="math inline">\(TNDE\)</span>, <span class="math inline">\(PNIE\)</span> and <span class="math inline">\(TNIE\)</span> by the following parameter functions:</p>
<ul>
<li><span class="math inline">\(CDE=\sum_{h=1}^H\theta_{1h}I\{a=h\}-\sum_{h=1}^H\theta_{1h}I\{a^*=h\}+(\sum_{h=1}^H\theta_{3h}I\{a=h\}-\sum_{h=1}^H\theta_{3h}I\{a^*=h\})m\)</span></li>
<li><span class="math inline">\(PNDE=\sum_{h=1}^H\theta_{1h}I\{a=h\}-\sum_{h=1}^H\theta_{1h}I\{a^*=h\}+(\sum_{h=1}^H\theta_{3h}I\{a=h\}-\sum_{h=1}^H\theta_{3h}I\{a^*=h\})(\beta_0+\sum_{h=1}^H\beta_{1h}I\{a^*=h\}+\beta_2'c)\)</span></li>
<li><span class="math inline">\(TNDE=\sum_{h=1}^H\theta_{1h}I\{a=h\}-\sum_{h=1}^H\theta_{1h}I\{a^*=h\}+(\sum_{h=1}^H\theta_{3h}I\{a=h\}-\sum_{h=1}^H\theta_{3h}I\{a^*=h\})(\beta_0+\sum_{h=1}^H\beta_{1h}I\{a=h\}+\beta_2'c)\)</span></li>
<li><span class="math inline">\(PNIE=(\theta_2+\sum_{h=1}^H\theta_{3h}I\{a^*=h\})(\sum_{h=1}^H\beta_{1h}I\{a=h\}-\sum_{h=1}^H\beta_{1h}I\{a^*=h\})\)</span></li>
<li><span class="math inline">\(TNIE=(\theta_2+\sum_{h=1}^H\theta_{3h}I\{a=h\})(\sum_{h=1}^H\beta_{1h}I\{a=h\}-\sum_{h=1}^H\beta_{1h}I\{a^*=h\})\)</span></li>
</ul>
</li>
<li><p>Calculate other effects using formulas in table 1.</p></li>
</ol>
</div>
<div id="linear-yreg-logistic-mreg-and-noncategorical-exposure" class="section level4">
<h4 class="hasAnchor">
<a href="#linear-yreg-logistic-mreg-and-noncategorical-exposure" class="anchor"></a>Linear <code>yreg</code>, Logistic <code>mreg</code> and Noncategorical Exposure</h4>
<p>If the exposure is not categorical, <code>yreg="linear"</code> and <code>mreg=list("logistic")</code>, <code>CMAverse</code> estimates the causal effects by the following steps:</p>
<ol style="list-style-type: decimal">
<li><p>Fit a logistic regression model for the mediator: <span class="math display">\[logitE[M|A,C]=\beta_0+\beta_1A+\beta_2'C\]</span></p></li>
<li><p>Fit a linear regression model for the outcome: <span class="math display">\[E[Y|A,M,C]=\theta_0+\theta_1A+\theta_2M+\theta_3AM+\theta_4'C\]</span></p></li>
<li>
<p>Estimate <span class="math inline">\(CDE\)</span>, <span class="math inline">\(PNDE\)</span>, <span class="math inline">\(TNDE\)</span>, <span class="math inline">\(PNIE\)</span> and <span class="math inline">\(TNIE\)</span> by the following parameter functions:</p>
<ul>
<li><span class="math inline">\(CDE=(\theta_1+\theta_3m)(a-a^*)\)</span></li>
<li><span class="math inline">\(PNDE=\{\theta_1+\theta_3\frac{exp(\beta_0+\beta_1a^*+\beta_2'c)}{1+exp(\beta_0+\beta_1a^*+\beta_2'c)}\}(a-a^*)\)</span></li>
<li><span class="math inline">\(TNDE=\{\theta_1+\theta_3\frac{exp(\beta_0+\beta_1a+\beta_2'c)}{1+exp(\beta_0+\beta_1a+\beta_2'c)}\}(a-a^*)\)</span></li>
<li><span class="math inline">\(PNIE=(\theta_2+\theta_3a^*)(\frac{exp(\beta_0+\beta_1a+\beta_2'c)}{1+exp(\beta_0+\beta_1a+\beta_2'c)}-\frac{exp(\beta_0+\beta_1a^*+\beta_2'c)}{1+exp(\beta_0+\beta_1a^*+\beta_2'c)})\)</span></li>
<li><span class="math inline">\(TNIE=(\theta_2+\theta_3a)(\frac{exp(\beta_0+\beta_1a+\beta_2'c)}{1+exp(\beta_0+\beta_1a+\beta_2'c)}-\frac{exp(\beta_0+\beta_1a^*+\beta_2'c)}{1+exp(\beta_0+\beta_1a^*+\beta_2'c)})\)</span></li>
</ul>
</li>
<li><p>Calculate other effects using formulas in table 1.</p></li>
</ol>
</div>
<div id="linear-yreg-logistic-mreg-and-categorical-exposure" class="section level4">
<h4 class="hasAnchor">
<a href="#linear-yreg-logistic-mreg-and-categorical-exposure" class="anchor"></a>Linear <code>yreg</code>, Logistic <code>mreg</code> and Categorical Exposure</h4>
<p>If the exposure is categorical, <code>yreg="linear"</code> and <code>mreg=list("logistic")</code>, <code>CMAverse</code> estimates the causal effects by the following steps:</p>
<ol style="list-style-type: decimal">
<li><p>Fit a logistic regression model for the mediator: <span class="math display">\[logitE[M|A,C]=\beta_0+\sum_{h=1}^H\beta_{1h}I\{A=h\}+\beta_2'C\]</span></p></li>
<li><p>Fit a linear regression model for the outcome: <span class="math display">\[E[Y|A,M,C]=\theta_0+\sum_{h=1}^H\theta_{1h}I\{A=h\}+\theta_2M+\sum_{h=1}^H\theta_{3h}I\{A=h\}M+\theta_4'C\]</span></p></li>
<li>
<p>Estimate <span class="math inline">\(CDE\)</span>, <span class="math inline">\(PNDE\)</span>, <span class="math inline">\(TNDE\)</span>, <span class="math inline">\(PNIE\)</span> and <span class="math inline">\(TNIE\)</span> by the following parameter functions:</p>
<ul>
<li><span class="math inline">\(CDE=\sum_{h=1}^H\theta_{1h}I\{a=h\}-\sum_{h=1}^H\theta_{1h}I\{a^*=h\}+(\sum_{h=1}^H\theta_{3h}I\{a=h\}-\sum_{h=1}^H\theta_{3h}I\{a^*=h\})m\)</span></li>
<li><span class="math inline">\(PNDE=\sum_{h=1}^H\theta_{1h}I\{a=h\}-\sum_{h=1}^H\theta_{1h}I\{a^*=h\}+(\sum_{h=1}^H\theta_{3h}I\{a=h\}-\sum_{h=1}^H\theta_{3h}I\{a^*=h\})\frac{exp(\beta_0+\sum_{h=1}^H\beta_{1h}I\{a^*=h\}+\beta_2'c)}{1+exp(\beta_0+\sum_{h=1}^H\beta_{1h}I\{a^*=h\}+\beta_2'c)}\)</span></li>
<li><span class="math inline">\(TNDE=\sum_{h=1}^H\theta_{1h}I\{a=h\}-\sum_{h=1}^H\theta_{1h}I\{a^*=h\}+(\sum_{h=1}^H\theta_{3h}I\{a=h\}-\sum_{h=1}^H\theta_{3h}I\{a^*=h\})\frac{exp(\beta_0+\sum_{h=1}^H\beta_{1h}I\{a=h\}+\beta_2'c)}{1+exp(\beta_0+\sum_{h=1}^H\beta_{1h}I\{a=h\}+\beta_2'c)}\)</span></li>
<li><span class="math inline">\(PNIE=(\theta_2+\sum_{h=1}^H\theta_{3h}I\{a^*=h\})(\frac{exp(\beta_0+\sum_{h=1}^H\beta_{1h}I\{a=h\}+\beta_2'c)}{1+exp(\beta_0+\sum_{h=1}^H\beta_{1h}I\{a=h\}+\beta_2'c)}-\frac{exp(\beta_0+\sum_{h=1}^H\beta_{1h}I\{a^*=h\}+\beta_2'c)}{1+exp(\beta_0+\sum_{h=1}^H\beta_{1h}I\{a^*=h\}+\beta_2'c)})\)</span></li>
<li><span class="math inline">\(TNIE=(\theta_2+\sum_{h=1}^H\theta_{3h}I\{a=h\})(\frac{exp(\beta_0+\sum_{h=1}^H\beta_{1h}I\{a=h\}+\beta_2'c)}{1+exp(\beta_0+\sum_{h=1}^H\beta_{1h}I\{a=h\}+\beta_2'c)}-\frac{exp(\beta_0+\sum_{h=1}^H\beta_{1h}I\{a^*=h\}+\beta_2'c)}{1+exp(\beta_0+\sum_{h=1}^H\beta_{1h}I\{a^*=h\}+\beta_2'c)})\)</span></li>
</ul>
</li>
<li><p>Calculate other effects using formulas in table 1.</p></li>
</ol>
</div>
<div id="linear-yreg-multinomial-mreg-and-noncategorical-exposure" class="section level4">
<h4 class="hasAnchor">
<a href="#linear-yreg-multinomial-mreg-and-noncategorical-exposure" class="anchor"></a>Linear <code>yreg</code>, Multinomial <code>mreg</code> and Noncategorical Exposure</h4>
<p>If the exposure is not categorical, <code>yreg="linear"</code> and <code>mreg=list("multinomial")</code>, <code>CMAverse</code> estimates the causal effects by the following steps:</p>
<ol style="list-style-type: decimal">
<li><p>Fit a multinomial regression model for the mediator: <span class="math display">\[log\frac{E[M=j|A,C]}{E[M=0|A,C]}=\beta_{0j}+\beta_{1j}A+\beta_{2j}'C, j=1,2,...,J\]</span></p></li>
<li><p>Fit a linear regression model for the outcome: <span class="math display">\[E[Y|A,M,C]=\theta_0+\theta_1A+\sum_{j=1}^J\theta_{2j}I\{M=j\}+A\sum_{j=1}^J\theta_{3j}I\{M=j\}+\theta_4'C\]</span></p></li>
<li>
<p>Estimate <span class="math inline">\(CDE\)</span>, <span class="math inline">\(PNDE\)</span>, <span class="math inline">\(TNDE\)</span>, <span class="math inline">\(PNIE\)</span> and <span class="math inline">\(TNIE\)</span> by the following parameter functions:</p>
<ul>
<li><span class="math inline">\(CDE=(\theta_1+\sum_{j=1}^J\theta_{3j}I\{m=j\})(a-a^*)\)</span></li>
<li><span class="math inline">\(PNDE=\{\theta_1+\frac{\sum_{j=1}^J\theta_{3j}exp(\beta_{0j}+\beta_{1j}a^*+\beta_{2j}'c)}{1+\sum_{j=1}^Jexp(\beta_{0j}+\beta_{1j}a^*+\beta_{2j}'c)}\}(a-a^*)\)</span></li>
<li><span class="math inline">\(TNDE=\{\theta_1+\frac{\sum_{j=1}^J\theta_{3j}exp(\beta_{0j}+\beta_{1j}a+\beta_{2j}'c)}{1+\sum_{j=1}^Jexp(\beta_{0j}+\beta_{1j}a+\beta_{2j}'c)}\}(a-a^*)\)</span></li>
<li><span class="math inline">\(PNIE=\frac{\sum_{j=1}^J(\theta_{2j}+\theta_{3j}a^*)exp(\beta_{0j}+\beta_{1j}a+\beta_{2j}'c)}{1+\sum_{j=1}^Jexp(\beta_{0j}+\beta_{1j}a+\beta_{2j}'c)}-\frac{\sum_{j=1}^J(\theta_{2j}+\theta_{3j}a^*)exp(\beta_{0j}+\beta_{1j}a^*+\beta_{2j}'c)}{1+\sum_{j=1}^Jexp(\beta_{0j}+\beta_{1j}a^*+\beta_{2j}'c)}\)</span></li>
<li><span class="math inline">\(TNIE=\frac{\sum_{j=1}^J(\theta_{2j}+\theta_{3j}a)exp(\beta_{0j}+\beta_{1j}a+\beta_{2j}'c)}{1+\sum_{j=1}^Jexp(\beta_{0j}+\beta_{1j}a+\beta_{2j}'c)}-\frac{\sum_{j=1}^J(\theta_{2j}+\theta_{3j}a)exp(\beta_{0j}+\beta_{1j}a^*+\beta_{2j}'c)}{1+\sum_{j=1}^Jexp(\beta_{0j}+\beta_{1j}a^*+\beta_{2j}'c)}\)</span></li>
</ul>
</li>
<li><p>Calculate other effects using formulas in table 1.</p></li>
</ol>
</div>
<div id="linear-yreg-multinomial-mreg-and-categorical-exposure" class="section level4">
<h4 class="hasAnchor">
<a href="#linear-yreg-multinomial-mreg-and-categorical-exposure" class="anchor"></a>Linear <code>yreg</code>, Multinomial <code>mreg</code> and Categorical Exposure</h4>
<p>If the exposure is categorical, <code>yreg="linear"</code> and <code>mreg=list("multinomial")</code>, <code>CMAverse</code> estimates the causal effects by the following steps:</p>
<ol style="list-style-type: decimal">
<li><p>Fit a multinomial regression model for the mediator: <span class="math display">\[log\frac{E[M=j|A,C]}{E[M=0|A,C]}=\beta_{0j}+\sum_{h=1}^H\beta_{1jh}I\{A=h\}+\beta_{2j}'C, j=1,2,...,J\]</span></p></li>
<li><p>Fit a linear regression model for the outcome: <span class="math display">\[E[Y|A,M,C]=\theta_0+\sum_{h=1}^H\theta_{1h}I\{A=h\}+\sum_{j=1}^J\theta_{2j}I\{M=j\}+\sum_{j=1}^J\sum_{h=1}^H\theta_{3jh}I\{M=j\}I\{A=h\}+\theta_4'C\]</span></p></li>
<li>
<p>Estimate <span class="math inline">\(CDE\)</span>, <span class="math inline">\(PNDE\)</span>, <span class="math inline">\(TNDE\)</span>, <span class="math inline">\(PNIE\)</span> and <span class="math inline">\(TNIE\)</span> by the following parameter functions:</p>
<ul>
<li><span class="math inline">\(CDE=\sum_{h=1}^H\theta_{1h}I\{a=h\}-\sum_{h=1}^H\theta_{1h}I\{a^*=h\}+(\sum_{j=1}^J\sum_{h=1}^H\theta_{3jh}I\{m=j\}I\{a=h\}-\sum_{j=1}^J\sum_{h=1}^H\theta_{3jh}I\{m=j\}I\{a^*=h\})\)</span></li>
<li><span class="math inline">\(PNDE=\sum_{h=1}^H\theta_{1h}I\{a=h\}-\sum_{h=1}^H\theta_{1h}I\{a^*=h\}+\frac{\sum_{j=1}^J(\sum_{h=1}^H\theta_{3jh}I\{a=h\}-\sum_{h=1}^H\theta_{3jh}I\{a^*=h\})exp(\beta_{0j}+\sum_{h=1}^H\beta_{1jh}I\{a^*=h\}+\beta_{2j}'c)}{1+\sum_{j=1}^Jexp(\beta_{0j}+\sum_{h=1}^H\beta_{1jh}I\{a^*=h\}+\beta_{2j}'c)}\)</span></li>
<li><span class="math inline">\(TNDE=\sum_{h=1}^H\theta_{1h}I\{a=h\}-\sum_{h=1}^H\theta_{1h}I\{a^*=h\}+\frac{\sum_{j=1}^J(\sum_{h=1}^H\theta_{3jh}I\{a=h\}-\sum_{h=1}^H\theta_{3jh}I\{a^*=h\})exp(\beta_{0j}+\sum_{h=1}^H\beta_{1jh}I\{a=h\}+\beta_{2j}'c)}{1+\sum_{j=1}^Jexp(\beta_{0j}+\sum_{h=1}^H\beta_{1jh}I\{a=h\}+\beta_{2j}'c)}\)</span></li>
<li><span class="math inline">\(PNIE=\frac{\sum_{j=1}^J(\theta_{2j}+\sum_{h=1}^H\theta_{3jh}I\{a^*=h\})exp(\beta_{0j}+\sum_{h=1}^H\beta_{1jh}I\{a=h\}+\beta_{2j}'c)}{1+\sum_{j=1}^Jexp(\beta_{0j}+\sum_{h=1}^H\beta_{1jh}I\{a=h\}+\beta_{2j}'c)}-\frac{\sum_{j=1}^J(\theta_{2j}+\sum_{h=1}^H\theta_{3jh}I\{a^*=h\})exp(\beta_{0j}+\sum_{h=1}^H\beta_{1jh}I\{a^*=h\}+\beta_{2j}'c)}{1+\sum_{j=1}^Jexp(\beta_{0j}+\sum_{h=1}^H\beta_{1jh}I\{a^*=h\}+\beta_{2j}'c)}\)</span></li>
<li><span class="math inline">\(TNIE=\frac{\sum_{j=1}^J(\theta_{2j}+\sum_{h=1}^H\theta_{3jh}I\{a=h\})exp(\beta_{0j}+\sum_{h=1}^H\beta_{1jh}I\{a=h\}+\beta_{2j}'c)}{1+\sum_{j=1}^Jexp(\beta_{0j}+\sum_{h=1}^H\beta_{1jh}I\{a=h\}+\beta_{2j}'c)}-\frac{\sum_{j=1}^J(\theta_{2j}+\sum_{h=1}^H\theta_{3jh}I\{a=h\})exp(\beta_{0j}+\sum_{h=1}^H\beta_{1jh}I\{a^*=h\}+\beta_{2j}'c)}{1+\sum_{j=1}^Jexp(\beta_{0j}+\sum_{h=1}^H\beta_{1jh}I\{a^*=h\}+\beta_{2j}'c)}\)</span></li>
</ul>
</li>
<li><p>Calculate other effects using formulas in table 1.</p></li>
</ol>
</div>
<div id="nonlinear-yreg-linear-mreg-and-noncategorical-exposure" class="section level4">
<h4 class="hasAnchor">
<a href="#nonlinear-yreg-linear-mreg-and-noncategorical-exposure" class="anchor"></a>Nonlinear <code>yreg</code>, Linear <code>mreg</code> and Noncategorical Exposure</h4>
<p>If the exposure is not categorical, <code>yreg!="linear"</code> and <code>mreg=list("linear")</code>, <code>CMAverse</code> estimates the causal effects by the following steps:</p>
<ol style="list-style-type: decimal">
<li><p>Fit a linear regression model for the mediator: <span class="math display">\[E[M|A,C]=\beta_0+\beta_1A+\beta_2'C+\epsilon_M,\epsilon_M\sim N(0,\sigma^2)\]</span></p></li>
<li><p>Fit the specified regression model for the outcome: <span class="math display">\[g(E[Y|A,M,C])=\theta_0+\theta_1A+\theta_2M+\theta_3AM+\theta_4'C\]</span></p></li>
<li>
<p>Estimate <span class="math inline">\(R^{CDE}\)</span>, <span class="math inline">\(R^{PNDE}\)</span>, <span class="math inline">\(R^{TNDE}\)</span>, <span class="math inline">\(R^{PNIE}\)</span>, <span class="math inline">\(R^{TNIE}\)</span> and <span class="math inline">\(ER^{CDE}\)</span> by the following parameter functions:</p>
<ul>
<li><span class="math inline">\(R^{CDE}=exp((\theta_1+\theta_3m)(a-a^*))\)</span></li>
<li><span class="math inline">\(R^{PNDE}=exp(\{\theta_1+\theta_3(\beta_0+\beta_1a^*+\beta_2'c+\theta_2\sigma^2)\}(a-a^*)+0.5\theta_3^2\sigma^2(a^2-a^{*2}))\)</span></li>
<li><span class="math inline">\(R^{TNDE}=exp(\{\theta_1+\theta_3(\beta_0+\beta_1a+\beta_2'c+\theta_2\sigma^2)\}(a-a^*)+0.5\theta_3^2\sigma^2(a^2-a^{*2}))\)</span></li>
<li><span class="math inline">\(R^{PNIE}=exp((\theta_2\beta_1+\theta_3\beta_1a^*)(a-a^*))\)</span></li>
<li><span class="math inline">\(R^{TNIE}=exp((\theta_2\beta_1+\theta_3\beta_1a)(a-a^*))\)</span></li>
<li><span class="math inline">\(ER^{CDE}=(exp(\theta_1(a-a^*)+\theta_3am)-exp(\theta_3a^*m))exp(\theta_2m-(\theta_2+\theta_3a^*)(\beta_0+\beta_1a^*+\beta_2'c)-0.5(\theta_2+\theta_3a^*)^2\sigma^2)\)</span></li>
</ul>
</li>
<li><p>Calculate other effects using formulas in table 2.</p></li>
</ol>
</div>
<div id="nonlinear-yreg-linear-mreg-and-categorical-exposure" class="section level4">
<h4 class="hasAnchor">
<a href="#nonlinear-yreg-linear-mreg-and-categorical-exposure" class="anchor"></a>Nonlinear <code>yreg</code>, Linear <code>mreg</code> and Categorical Exposure</h4>
<p>If the exposure is categorical, <code>yreg!="linear"</code> and <code>mreg=list("linear")</code>, <code>CMAverse</code> estimates the causal effects by the following steps:</p>
<ol style="list-style-type: decimal">
<li><p>Fit a linear regression model for the mediator: <span class="math display">\[E[M|A,C]=\beta_0+\sum_{h=1}^H\beta_{1h}I\{A=h\}+\beta_2'C+\epsilon_M,\epsilon_M\sim N(0,\sigma^2)\]</span></p></li>
<li><p>Fit the specified regression model for the outcome: <span class="math display">\[g(E[Y|A,M,C])=\theta_0+\sum_{h=1}^H\theta_{1h}I\{A=h\}+\theta_2M+\sum_{h=1}^H\theta_{3h}I\{A=h\}M+\theta_4'C\]</span></p></li>
<li>
<p>Estimate <span class="math inline">\(R^{CDE}\)</span>, <span class="math inline">\(R^{PNDE}\)</span>, <span class="math inline">\(R^{TNDE}\)</span>, <span class="math inline">\(R^{PNIE}\)</span>, <span class="math inline">\(R^{TNIE}\)</span> and <span class="math inline">\(ER^{CDE}\)</span> by the following parameter functions:</p>
<ul>
<li><span class="math inline">\(R^{CDE}=exp(\sum_{h=1}^H\theta_{1h}I\{a=h\}-\sum_{h=1}^H\theta_{1h}I\{a^*=h\}+(\sum_{h=1}^H\theta_{3h}I\{a=h\}-\sum_{h=1}^H\theta_{3h}I\{a^*=h\})m)\)</span></li>
<li><span class="math inline">\(R^{PNDE}=exp(\sum_{h=1}^H\theta_{1h}I\{a=h\}-\sum_{h=1}^H\theta_{1h}I\{a^*=h\}+(\sum_{h=1}^H\theta_{3h}I\{a=h\}-\sum_{h=1}^H\theta_{3h}I\{a^*=h\})(\beta_0+\sum_{h=1}^H\beta_{1h}I\{a^*=h\}+\beta_2'c+\theta_2\sigma^2)+0.5\sigma^2(\sum_{h=1}^H\theta_{3h}^2I\{a=h\}-\sum_{h=1}^H\theta_{3h}^2I\{a^*=h\}))\)</span></li>
<li><span class="math inline">\(R^{TNDE}=exp(\sum_{h=1}^H\theta_{1h}I\{a=h\}-\sum_{h=1}^H\theta_{1h}I\{a^*=h\}+(\sum_{h=1}^H\theta_{3h}I\{a=h\}-\sum_{h=1}^H\theta_{3h}I\{a^*=h\})(\beta_0+\sum_{h=1}^H\beta_{1h}I\{a=h\}+\beta_2'c+\theta_2\sigma^2)+0.5\sigma^2(\sum_{h=1}^H\theta_{3h}^2I\{a=h\}-\sum_{h=1}^H\theta_{3h}^2I\{a^*=h\}))\)</span></li>
<li><span class="math inline">\(R^{PNIE}=exp(\theta_2(\sum_{h=1}^H\beta_{1h}I\{a=h\}-\sum_{h=1}^H\beta_{1h}I\{a^*=h\})+\sum_{h=1}^H\theta_{3h}I\{a^*=h\}(\sum_{h=1}^H\beta_{1h}I\{a=h\}-\sum_{h=1}^H\beta_{1h}I\{a^*=h\}))\)</span></li>
<li><span class="math inline">\(R^{TNIE}=exp(\theta_2(\sum_{h=1}^H\beta_{1h}I\{a=h\}-\sum_{h=1}^H\beta_{1h}I\{a^*=h\})+\sum_{h=1}^H\theta_{3h}I\{a=h\}(\sum_{h=1}^H\beta_{1h}I\{a=h\}-\sum_{h=1}^H\beta_{1h}I\{a^*=h\}))\)</span></li>
<li><span class="math inline">\(ER^{CDE}=(exp(\sum_{h=1}^H\theta_{1h}I\{a=h\}-\sum_{h=1}^H\theta_{1h}I\{a^*=h\}+\sum_{h=1}^H\theta_{3h}I\{a=h\}m)-exp(\sum_{h=1}^H\theta_{3h}I\{a^*=h\}m))exp(\theta_2m-(\theta_2+\sum_{h=1}^H\theta_{3h}I\{a^*=h\})(\beta_0+\sum_{h=1}^H\beta_{1h}I\{a^*=h\}+\beta_2'c)-0.5(\theta_2+\sum_{h=1}^H\theta_{3h}I\{a^*=h\})^2\sigma^2)\)</span></li>
</ul>
</li>
<li><p>Calculate other effects using formulas in table 2.</p></li>
</ol>
</div>
<div id="nonlinear-yreg-logistic-mreg-and-noncategorical-exposure" class="section level4">
<h4 class="hasAnchor">
<a href="#nonlinear-yreg-logistic-mreg-and-noncategorical-exposure" class="anchor"></a>Nonlinear <code>yreg</code>, Logistic <code>mreg</code> and Noncategorical Exposure</h4>
<p>If the exposure is not categorical, <code>yreg!="linear"</code> and <code>mreg=list("logistic")</code>, <code>CMAverse</code> estimates the causal effects by the following steps:</p>
<ol style="list-style-type: decimal">
<li><p>Fit a logistic regression model for the mediator: <span class="math display">\[logitE[M|A,C]=\beta_0+\beta_1A+\beta_2'C\]</span></p></li>
<li><p>Fit the specified regression model for the outcome: <span class="math display">\[g(E[Y|A,M,C])=\theta_0+\theta_1A+\theta_2M+\theta_3AM+\theta_4'C\]</span></p></li>
<li>
<p>Estimate <span class="math inline">\(R^{CDE}\)</span>, <span class="math inline">\(R^{PNDE}\)</span>, <span class="math inline">\(R^{TNDE}\)</span>, <span class="math inline">\(R^{PNIE}\)</span>, <span class="math inline">\(R^{TNIE}\)</span> and <span class="math inline">\(ER^{CDE}\)</span> by the following parameter functions:</p>
<ul>
<li><span class="math inline">\(R^{CDE}=exp((\theta_1+\theta_3m)(a-a^*))\)</span></li>
<li><span class="math inline">\(R^{PNDE}=\frac{exp(\theta_1a)\{1+exp(\theta_2+\theta_3a+\beta_0+\beta_1a^*+\beta_2'c)\}}{exp(\theta_1a^*)\{1+exp(\theta_2+\theta_3a^*+\beta_0+\beta_1a^*+\beta_2'c)\}}\)</span></li>
<li><span class="math inline">\(R^{TNDE}=\frac{exp(\theta_1a)\{1+exp(\theta_2+\theta_3a+\beta_0+\beta_1a+\beta_2'c)\}}{exp(\theta_1a^*)\{1+exp(\theta_2+\theta_3a^*+\beta_0+\beta_1a+\beta_2'c)\}}\)</span></li>
<li><span class="math inline">\(R^{PNIE}=\frac{\{1+exp(\beta_0+\beta_1a^*+\beta_2'c)\}\{1+exp(\theta_2+\theta_3a^*+\beta_0+\beta_1a+\beta_2'c)\}}{\{1+exp(\beta_0+\beta_1a+\beta_2'c)\}\{1+exp(\theta_2+\theta_3a^*+\beta_0+\beta_1a^*+\beta_2'c)\}}\)</span></li>
<li><span class="math inline">\(R^{TNIE}=\frac{\{1+exp(\beta_0+\beta_1a^*+\beta_2'c)\}\{1+exp(\theta_2+\theta_3a+\beta_0+\beta_1a+\beta_2'c)\}}{\{1+exp(\beta_0+\beta_1a+\beta_2'c)\}\{1+exp(\theta_2+\theta_3a+\beta_0+\beta_1a^*+\beta_2'c)\}}\)</span></li>
<li><span class="math inline">\(ER^{CDE}=\frac{exp(\theta_2m)(exp(\theta_1(a-a^*)+\theta_3am)-exp(\theta_3a^*m))(1+exp(\beta_0+\beta_1a^*+\beta_2'c))}{1+exp(\beta_0+\beta_1a^*+\beta_2'c+\theta_2+\theta_3a^*)}\)</span></li>
</ul>
</li>
<li><p>Calculate other effects using formulas in table 2.</p></li>
</ol>
</div>
<div id="nonlinear-yreg-logistic-mreg-and-categorical-exposure" class="section level4">
<h4 class="hasAnchor">
<a href="#nonlinear-yreg-logistic-mreg-and-categorical-exposure" class="anchor"></a>Nonlinear <code>yreg</code>, Logistic <code>mreg</code> and Categorical Exposure</h4>
<p>If the exposure is categorical, <code>yreg!="linear"</code> and <code>mreg=list("logistic")</code>, <code>CMAverse</code> estimates the causal effects by the following steps:</p>
<ol style="list-style-type: decimal">
<li><p>Fit a logistic regression model for the mediator: <span class="math display">\[logitE[M|A,C]=\beta_0+\sum_{h=1}^H\beta_{1h}I\{A=h\}+\beta_2'C\]</span></p></li>
<li><p>Fit the specified regression model for the outcome: <span class="math display">\[g(E[Y|A,M,C])=\theta_0+\sum_{h=1}^H\theta_{1h}I\{A=h\}+\theta_2M+\sum_{h=1}^H\theta_{3h}I\{A=h\}M+\theta_4'C\]</span></p></li>
<li>
<p>Estimate <span class="math inline">\(R^{CDE}\)</span>, <span class="math inline">\(R^{PNDE}\)</span>, <span class="math inline">\(R^{TNDE}\)</span>, <span class="math inline">\(R^{PNIE}\)</span>, <span class="math inline">\(R^{TNIE}\)</span> and <span class="math inline">\(ER^{CDE}\)</span> by the following parameter functions:</p>
<ul>
<li><span class="math inline">\(R^{CDE}=exp(\sum_{h=1}^H\theta_{1h}I\{a=h\}-\sum_{h=1}^H\theta_{1h}I\{a^*=h\}+(\sum_{h=1}^H\theta_{3h}I\{a=h\}-\sum_{h=1}^H\theta_{3h}I\{a^*=h\})m)\)</span></li>
<li><span class="math inline">\(R^{PNDE}=\frac{exp(\sum_{h=1}^H\theta_{1h}I\{a=h\})\{1+exp(\theta_2+\sum_{h=1}^H\theta_{3h}I\{a=h\}+\beta_0+\sum_{h=1}^H\beta_{1h}I\{a^*=h\}+\beta_2'c)\}}{exp(\sum_{h=1}^H\theta_{1h}I\{a^*=h\})\{1+exp(\theta_2+\sum_{h=1}^H\theta_{3h}I\{a^*=h\}+\beta_0+\sum_{h=1}^H\beta_{1h}I\{a^*=h\}+\beta_2'c)\}}\)</span></li>
<li><span class="math inline">\(R^{TNDE}=\frac{exp(\sum_{h=1}^H\theta_{1h}I\{a=h\})\{1+exp(\theta_2+\sum_{h=1}^H\theta_{3h}I\{a=h\}+\beta_0+\sum_{h=1}^H\beta_{1h}I\{a=h\}+\beta_2'c)\}}{exp(\sum_{h=1}^H\theta_{1h}I\{a^*=h\})\{1+exp(\theta_2+\sum_{h=1}^H\theta_{3h}I\{a^*=h\}+\beta_0+\sum_{h=1}^H\beta_{1h}I\{a=h\}+\beta_2'c)\}}\)</span></li>
<li><span class="math inline">\(R^{PNIE}=\frac{\{1+exp(\beta_0+\sum_{h=1}^H\beta_{1h}I\{a^*=h\}+\beta_2'c)\}\{1+exp(\theta_2+\sum_{h=1}^H\theta_{3h}I\{a^*=h\}+\beta_0+\sum_{h=1}^H\beta_{1h}I\{a=h\}+\beta_2'c)\}}{\{1+exp(\beta_0+\sum_{h=1}^H\beta_{1h}I\{a=h\}+\beta_2'c)\}\{1+exp(\theta_2+\sum_{h=1}^H\theta_{3h}I\{a^*=h\}+\beta_0+\sum_{h=1}^H\beta_{1h}I\{a^*=h\}+\beta_2'c)\}}\)</span></li>
<li><span class="math inline">\(R^{TNIE}=\frac{\{1+exp(\beta_0+\sum_{h=1}^H\beta_{1h}I\{a^*=h\}+\beta_2'c)\}\{1+exp(\theta_2+\sum_{h=1}^H\theta_{3h}I\{a=h\}+\beta_0+\sum_{h=1}^H\beta_{1h}I\{a=h\}+\beta_2'c)\}}{\{1+exp(\beta_0+\sum_{h=1}^H\beta_{1h}I\{a=h\}+\beta_2'c)\}\{1+exp(\theta_2+\sum_{h=1}^H\theta_{3h}I\{a=h\}+\beta_0+\sum_{h=1}^H\beta_{1h}I\{a^*=h\}+\beta_2'c)\}}\)</span></li>
<li><span class="math inline">\(ER^{CDE}=\frac{exp(\theta_2m)(exp(\sum_{h=1}^H\theta_{1h}I\{a=h\}-\sum_{h=1}^H\theta_{1h}I\{a^*=h\}+\sum_{h=1}^H\theta_{3h}I\{a=h\}m)-exp(\sum_{h=1}^H\theta_{3h}I\{a^*=h\}m))(1+exp(\beta_0+\sum_{h=1}^H\beta_{1h}I\{a^*=h\}+\beta_2'c))}{1+exp(\beta_0+\sum_{h=1}^H\beta_{1h}I\{a^*=h\}+\beta_2'c+\theta_2+\sum_{h=1}^H\theta_{3h}I\{a^*=h\})}\)</span></li>
</ul>
</li>
<li><p>Calculate other effects using formulas in table 2.</p></li>
</ol>
</div>
<div id="nonlinear-yreg-multinomial-mreg-and-noncategorical-exposure" class="section level4">
<h4 class="hasAnchor">
<a href="#nonlinear-yreg-multinomial-mreg-and-noncategorical-exposure" class="anchor"></a>Nonlinear <code>yreg</code>, Multinomial <code>mreg</code> and Noncategorical Exposure</h4>
<p>If the exposure is not categorical, <code>yreg!="linear"</code> and <code>mreg=list("multinomial")</code>, <code>CMAverse</code> estimates the causal effects by the following steps:</p>
<ol style="list-style-type: decimal">
<li><p>Fit a multinomial regression model for the mediator: <span class="math display">\[log\frac{E[M=j|A,C]}{E[M=0|A,C]}=\beta_{0j}+\beta_{1j}A+\beta_{2j}'C, j=1,2,...,J\]</span></p></li>
<li><p>Fit the specified regression model for the outcome: <span class="math display">\[g(E[Y|A,M,C])=\theta_0+\theta_1A+\sum_{j=1}^J\theta_{2j}I\{M=j\}+A\sum_{j=1}^J\theta_{3j}I\{M=j\}+\theta_4'C\]</span></p></li>
<li>
<p>Estimate <span class="math inline">\(R^{CDE}\)</span>, <span class="math inline">\(R^{PNDE}\)</span>, <span class="math inline">\(R^{TNDE}\)</span>, <span class="math inline">\(R^{PNIE}\)</span>, <span class="math inline">\(R^{TNIE}\)</span> and <span class="math inline">\(ER^{CDE}\)</span> by the following parameter functions:</p>
<ul>
<li><span class="math inline">\(R^{CDE}=exp((\theta_1+\sum_{j=1}^J\theta_{3j}I\{m=j\})(a-a^*))\)</span></li>
<li><span class="math inline">\(R^{PNDE}=\frac{exp(\theta_1a)\{1+\sum_{j=1}^Jexp(\theta_{2j}+\theta_{3j}a+\beta_{0j}+\beta_{1j}a^*+\beta_{2j}'c)\}}{exp(\theta_1a^*)\{1+\sum_{j=1}^Jexp(\theta_{2j}+\theta_{3j}a^*+\beta_{0j}+\beta_{1j}a^*+\beta_{2j}'c)\}}\)</span></li>
<li><span class="math inline">\(R^{TNDE}=\frac{exp(\theta_1a)\{1+\sum_{j=1}^Jexp(\theta_{2j}+\theta_{3j}a+\beta_{0j}+\beta_{1j}a+\beta_{2j}'c)\}}{exp(\theta_1a^*)\{1+\sum_{j=1}^Jexp(\theta_{2j}+\theta_{3j}a^*+\beta_{0j}+\beta_{1j}a+\beta_{2j}'c)\}}\)</span></li>
<li><span class="math inline">\(R^{PNIE}=\frac{\{1+\sum_{j=1}^Jexp(\beta_{0j}+\beta_{1j}a^*+\beta_{2j}'c)\}\{1+\sum_{j=1}^Jexp(\theta_{2j}+\theta_{3j}a^*+\beta_{0j}+\beta_{1j}a+\beta_{2j}'c)\}}{\{1+\sum_{j=1}^Jexp(\beta_{0j}+\beta_{1j}a+\beta_{2j}'c)\}\{1+\sum_{j=1}^Jexp(\theta_{2j}+\theta_{3j}a^*+\beta_{0j}+\beta_{1j}a^*+\beta_{2j}'c)\}}\)</span></li>
<li><span class="math inline">\(R^{TNIE}=\frac{\{1+\sum_{j=1}^Jexp(\beta_{0j}+\beta_{1j}a^*+\beta_{2j}'c)\}\{1+\sum_{j=1}^Jexp(\theta_{2j}+\theta_{3j}a+\beta_{0j}+\beta_{1j}a+\beta_{2j}'c)\}}{\{1+\sum_{j=1}^Jexp(\beta_{0j}+\beta_{1j}a+\beta_{2j}'c)\}\{1+\sum_{j=1}^Jexp(\theta_{2j}+\theta_{3j}a+\beta_{0j}+\beta_{1j}a^*+\beta_{2j}'c)\}}\)</span></li>
<li><span class="math inline">\(ER^{CDE}=\frac{exp(\sum_{j=1}^J\theta_{2j}I\{m=j\})(1+\sum_{j=1}^Jexp(\beta_{0j}+\beta_{1j}a^*+\beta_{2j}'c))(exp(\theta_1(a-a^*)+a\sum_{j=1}^J\theta_{3j}I\{m=j\})-exp(a^*\sum_{j=1}^J\theta_{3j}I\{m=j\}))}{1+\sum_{j=1}^Jexp(\theta_{2j}+\theta_{3j}a^*+\beta_{0j}+\beta_{1j}a^*+\beta_{2j}'c)}\)</span></li>
</ul>
</li>
<li><p>Calculate other effects using formulas in table 2.</p></li>
</ol>
</div>
<div id="nonlinear-yreg-multinomial-mreg-and-categorical-exposure" class="section level4">
<h4 class="hasAnchor">
<a href="#nonlinear-yreg-multinomial-mreg-and-categorical-exposure" class="anchor"></a>Nonlinear <code>yreg</code>, Multinomial <code>mreg</code> and Categorical Exposure</h4>
<p>If the exposure is categorical, <code>yreg!="linear"</code> and <code>mreg=list("multinomial")</code>, <code>CMAverse</code> estimates the causal effects by the following steps:</p>
<ol style="list-style-type: decimal">
<li><p>Fit a multinomial regression model for the mediator: <span class="math display">\[log\frac{E[M=j|A,C]}{E[M=0|A,C]}=\beta_{0j}+\sum_{h=1}^H\beta_{1jh}I\{A=h\}+\beta_{2j}'C, j=1,2,...,J\]</span></p></li>
<li><p>Fit the specified regression model for the outcome: <span class="math display">\[g(E[Y|A,M,C])=\theta_0+\sum_{h=1}^H\theta_{1h}I\{A=h\}+\sum_{j=1}^J\theta_{2j}I\{M=j\}+\sum_{j=1}^J\sum_{h=1}^H\theta_{3jh}I\{M=j\}I\{A=h\}+\theta_4'C\]</span></p></li>
<li>
<p>Estimate <span class="math inline">\(R^{CDE}\)</span>, <span class="math inline">\(R^{PNDE}\)</span>, <span class="math inline">\(R^{TNDE}\)</span>, <span class="math inline">\(R^{PNIE}\)</span>, <span class="math inline">\(R^{TNIE}\)</span> and <span class="math inline">\(ER^{CDE}\)</span> by the following parameter functions:</p>
<ul>
<li><span class="math inline">\(R^{CDE}=exp(\sum_{h=1}^H\theta_{1h}I\{a=h\}-\sum_{h=1}^H\theta_{1h}I\{a^*=h\}+\sum_{j=1}^J\sum_{h=1}^H\theta_{3jh}I\{m=l\}I\{a=h\}-\sum_{j=1}^J\sum_{h=1}^H\theta_{3jh}I\{m=l\}I\{a^*=h\})\)</span></li>
<li><span class="math inline">\(R^{PNDE}=\frac{exp(\sum_{h=1}^H\theta_{1h}I\{a=h\})\{1+\sum_{j=1}^Jexp(\theta_{2j}+\sum_{h=1}^H\theta_{3jh}I\{a=h\}+\beta_{0j}+\sum_{h=1}^H\beta_{1jh}I\{a^*=h\}+\beta_{2j}'c)\}}{exp(\sum_{h=1}^H\theta_{1h}I\{a^*=h\})\{1+\sum_{j=1}^Jexp(\theta_{2j}+\sum_{h=1}^H\theta_{3jh}I\{a^*=h\}+\beta_{0j}+\sum_{h=1}^H\beta_{1jh}I\{a^*=h\}+\beta_{2j}'c)\}}\)</span></li>
<li><span class="math inline">\(R^{TNDE}=\frac{exp(\sum_{h=1}^H\theta_{1h}I\{a=h\})\{1+\sum_{j=1}^Jexp(\theta_{2j}+\sum_{h=1}^H\theta_{3jh}I\{a=h\}+\beta_{0j}+\sum_{h=1}^H\beta_{1jh}I\{a=h\}+\beta_{2j}'c)\}}{exp(\sum_{h=1}^H\theta_{1h}I\{a^*=h\})\{1+\sum_{j=1}^Jexp(\theta_{2j}+\sum_{h=1}^H\theta_{3jh}I\{a^*=h\}+\beta_{0j}+\sum_{h=1}^H\beta_{1jh}I\{a=h\}+\beta_{2j}'c)\}}\)</span></li>
<li><span class="math inline">\(R^{PNIE}=\frac{\{1+\sum_{j=1}^Jexp(\beta_{0j}+\sum_{h=1}^H\beta_{1jh}I\{a^*=h\}+\beta_{2j}'c)\}\{1+\sum_{j=1}^Jexp(\theta_{2j}+\sum_{h=1}^H\theta_{3jh}I\{a^*=h\}+\beta_{0j}+\sum_{h=1}^H\beta_{1jh}I\{a=h\}+\beta_{2j}'c)\}}{\{1+\sum_{j=1}^Jexp(\beta_{0j}+\sum_{h=1}^H\beta_{1jh}I\{a=h\}+\beta_{2j}'c)\}\{1+\sum_{j=1}^Jexp(\theta_{2j}+\sum_{h=1}^H\theta_{3jh}I\{a^*=h\}+\beta_{0j}+\sum_{h=1}^H\beta_{1jh}I\{a^*=h\}+\beta_{2j}'c)\}}\)</span></li>
<li><span class="math inline">\(R^{TNIE}=\frac{\{1+\sum_{j=1}^Jexp(\beta_{0j}+\sum_{h=1}^H\beta_{1jh}I\{a^*=h\}+\beta_{2j}'c)\}\{1+\sum_{j=1}^Jexp(\theta_{2j}+\sum_{h=1}^H\theta_{3jh}I\{a=h\}+\beta_{0j}+\sum_{h=1}^H\beta_{1jh}I\{a=h\}+\beta_{2j}'c)\}}{\{1+\sum_{j=1}^Jexp(\beta_{0j}+\sum_{h=1}^H\beta_{1jh}I\{a=h\}+\beta_{2j}'c)\}\{1+\sum_{j=1}^Jexp(\theta_{2j}+\sum_{h=1}^H\theta_{3jh}I\{a=h\}+\beta_{0j}+\sum_{h=1}^H\beta_{1jh}I\{a^*=h\}+\beta_{2j}'c)\}}\)</span></li>
<li><span class="math inline">\(ER^{CDE}=\frac{exp(\sum_{j=1}^J\theta_{2j}I\{m=j\})(1+\sum_{j=1}^Jexp(\beta_{0j}+\sum_{h=1}^H\beta_{1jh}I\{a^*=h\}+\beta_{2j}'c))(exp((\sum_{h=1}^H\theta_{1h}I\{a=h\}-\sum_{h=1}^H\theta_{1h}I\{a^*=h\})+\sum_{j=1}^J\sum_{h=1}^H\theta_{3jh}I\{a=h\}I\{m=j\})-exp(\sum_{j=1}^J\sum_{h=1}^H\theta_{3jh}I\{a^*=h\}I\{m=j\}))}{1+\sum_{j=1}^Jexp(\theta_{2j}+\sum_{h=1}^H\theta_{3jh}I\{a^*=h\}+\beta_{0j}+\sum_{h=1}^H\beta_{1jh}I\{a^*=h\}+\beta_{2j}'c)}\)</span></li>
</ul>
</li>
<li><p>Calculate other effects using formulas in table 2.</p></li>
</ol>
</div>
</div>
<div id="direct-counterfactual-imputation-estimation" class="section level3">
<h3 class="hasAnchor">
<a href="#direct-counterfactual-imputation-estimation" class="anchor"></a>Direct Counterfactual Imputation Estimation</h3>
<p><code>CMAverse</code> conducts direct counterfactual imputation estimation by the following steps:</p>
<ol style="list-style-type: decimal">
<li><p>Fit a regression model for <span class="math inline">\(E(Y|A,M,C)\)</span>. This regression model is specified by the <code>yreg</code> argument.</p></li>
<li><p>For <span class="math inline">\(p=1,...,k\)</span>, fit a regression model for the distribution of <span class="math inline">\(M_p\)</span> given <span class="math inline">\(A\)</span> and <span class="math inline">\(C\)</span>. These regression models are specified by the <code>mreg</code> argument.</p></li>
<li>
<p>For <span class="math inline">\(p=1,...,k\)</span> and <span class="math inline">\(i=1,...,n\)</span>, simulate the counterfactuals <span class="math inline">\(M_{a,p,i}\)</span> and <span class="math inline">\(M_{a^*,p,i}\)</span>.</p>
<ul>
<li>Simulate <span class="math inline">\(M_{a,p,i}\)</span> by randomly drawing a value from the distribution of <span class="math inline">\(M_{p}\)</span> given <span class="math inline">\(A=a,C=C_i\)</span>. Denote <span class="math inline">\(M_{a,i}=(M_{a,1,i},...,M_{a,k,i})^T\)</span>.</li>
<li>Simulate <span class="math inline">\(M_{a^*,p,i}\)</span> by randomly drawing a value from the distribution of <span class="math inline">\(M_{p}\)</span> given <span class="math inline">\(A=a^*,C=C_i\)</span>. Denote <span class="math inline">\(M_{a^*,i}=(M_{a^*,1,i},...,M_{a^*,k,i})^T\)</span>.</li>
</ul>
</li>
<li><p>For <span class="math inline">\(i=1,...,n\)</span>, obtain <span class="math inline">\(E[Y_i|A=a^*,M=m,C=C_i]\)</span>, <span class="math inline">\(E[Y_i|A=a,M=m,C=C_i]\)</span>, <span class="math inline">\(E[Y_i|A=a^*,M=M_{a^*,i},C=C_i]\)</span>, <span class="math inline">\(E[Y_i|A=a^*,M=M_{a,i},C=C_i]\)</span>, <span class="math inline">\(E[Y_i|A=a,M=M_{a^*,i},C=C_i]\)</span> and <span class="math inline">\(E[Y_i|A=a,M=M_{a,i},C=C_i]\)</span> from the regression model in step 1.</p></li>
<li>
<p>Impute the counterfactuals <span class="math inline">\(E[Y_{a^*m}]\)</span>, <span class="math inline">\(E[Y_{am}]\)</span>, <span class="math inline">\(E[Y_{a^*Ma^*}]\)</span>, <span class="math inline">\(E[Y_{aMa}]\)</span>, <span class="math inline">\(E[Y_{aMa^*}]\)</span> and <span class="math inline">\(E[Y_{a^*Ma}]\)</span>.</p>
<ul>
<li>Impute <span class="math inline">\(E[Y_{a^*m}]\)</span> by taking an average of <span class="math inline">\(\{E[Y_i|A=a^*,M=m,C=C_i]\}_{i=1,...,n}\)</span>.</li>
<li>Impute <span class="math inline">\(E[Y_{am}]\)</span> by taking an average of <span class="math inline">\(\{E[Y_i|A=a,M=m,C=C_i]\}_{i=1,...,n}\)</span>.</li>
<li>Impute <span class="math inline">\(E[Y_{a^*Ma^*}]\)</span> by taking an average of <span class="math inline">\(\{E[Y_i|A=a^*,M=M_{a^*,i},C=C_i]\}_{i=1,...,n}\)</span>.</li>
<li>Impute <span class="math inline">\(E[Y_{aMa}]\)</span> by taking an average of <span class="math inline">\(\{E[Y_i|A=a,M=M_{a,i},C=C_i]\}_{i=1,...,n}\)</span>.</li>
<li>Impute <span class="math inline">\(E[Y_{aMa^*}]\)</span> by taking an average of <span class="math inline">\(\{E[Y_i|A=a,M=M_{a^*,i},C=C_i]\}_{i=1,...,n}\)</span>.</li>
<li>Impute <span class="math inline">\(E[Y_{a^*Ma}]\)</span> by taking an average of <span class="math inline">\(\{E[Y_i|A=a^*,M=M_{a,i},C=C_i]\}_{i=1,...,n}\)</span>.</li>
</ul>
</li>
<li><p>Calculate causal effects with formulas in table 1 or table 2.</p></li>
</ol>
</div>
</div>
<div id="the-weighting-based-approach" class="section level2">
<h2 class="hasAnchor">
<a href="#the-weighting-based-approach" class="anchor"></a>The Weighting-based Approach</h2>
<p>With the weighting-based approach, <code>CMAverse</code> estimates causal effects through direct counterfactual imputation estimation by the following steps:</p>
<ol style="list-style-type: decimal">
<li><p>Fit a regression model for the distribution of <span class="math inline">\(E(Y|A,M,C)\)</span>. This regression model is specified by the <code>yreg</code> argument.</p></li>
<li><p>If <span class="math inline">\(C\)</span> is not empty, fit a regression model for <span class="math inline">\(P(A|C)\)</span> and obtain <span class="math inline">\(P(A=A_i|C=C_i)\)</span> for <span class="math inline">\(i=1,...,n\)</span>. This regression model is specified by the <code>ereg</code> argument.</p></li>
<li><p>For <span class="math inline">\(i=1,...,n\)</span>, obtain <span class="math inline">\(E[Y_i|A=a^*,M=m,C=C_i]\)</span>, <span class="math inline">\(E[Y_i|A=a,M=m,C=C_i]\)</span>, <span class="math inline">\(E[Y_i|A=a^*,M=M_i,C=C_i]\)</span> and <span class="math inline">\(E[Y_i|A=a,M=M_i,C=C_i]\)</span> from the regression model in step 1.</p></li>
<li>
<p>Impute the counterfactuals <span class="math inline">\(E[Y_{a^*m}]\)</span>, <span class="math inline">\(E[Y_{am}]\)</span>, <span class="math inline">\(E[Y_{a^*Ma^*}]\)</span>, <span class="math inline">\(E[Y_{aMa}]\)</span>, <span class="math inline">\(E[Y_{aMa^*}]\)</span> and <span class="math inline">\(E[Y_{a^*Ma}]\)</span>.</p>
<ul>
<li>Impute <span class="math inline">\(E[Y_{a^*m}]\)</span> by taking an average of <span class="math inline">\(\{E[Y_i|A=a^*,M=m,C=C_i]\}_{i=1,...,n}\)</span>.</li>
<li>Impute <span class="math inline">\(E[Y_{am}]\)</span> by taking an average of <span class="math inline">\(\{E[Y_i|A=a,M=m,C=C_i]\}_{i=1,...,n}\)</span>.</li>
<li>Impute <span class="math inline">\(E[Y_{a^*Ma^*}]\)</span> by taking a weighted average of <span class="math inline">\(\{Y_i\}_{i\in \{i:A_i=a^*\}}\)</span>, and each subject i is given a weight <span class="math inline">\(\frac{P(A=A_i)}{P(A=A_i|C=C_i)}\)</span>.</li>
<li>Impute <span class="math inline">\(E[Y_{aMa}]\)</span> by taking a weighted average of <span class="math inline">\(\{Y_i\}_{i\in \{i:A_i=a\}}\)</span>, and each subject i is given a weight <span class="math inline">\(\frac{P(A=A_i)}{P(A=A_i|C=C_i)}\)</span>.</li>
<li>Impute <span class="math inline">\(E[Y_{aMa^*}]\)</span> by taking a weighted average of <span class="math inline">\(\{E[Y_i|A=a,M=M_i,C=C_i]\}_{i\in \{i:A_i=a^*\}}\)</span>, and each subject i is given a weight <span class="math inline">\(\frac{P(A=A_i)}{P(A=A_i|C=C_i)}\)</span>.</li>
<li>Impute <span class="math inline">\(E[Y_{a^*Ma}]\)</span> by taking a weighted average of <span class="math inline">\(\{E[Y_i|A=a^*,M=M_i,C=C_i]\}_{i\in \{i:A_i=a\}}\)</span>, and each subject i is given a weight <span class="math inline">\(\frac{P(A=A_i)}{P(A=A_i|C=C_i)}\)</span>.</li>
</ul>
</li>
<li><p>Calculate causal effects with formulas in table 1 or table 2.</p></li>
</ol>
</div>
<div id="the-inverse-odds-ratio-weighting-approach" class="section level2">
<h2 class="hasAnchor">
<a href="#the-inverse-odds-ratio-weighting-approach" class="anchor"></a>The Inverse Odds Ratio Weighting Approach</h2>
<p>With the inverse odds ratio weighting approach, <code>CMAverse</code> estimates causal effects through direct counterfactual imputation estimation by the following steps:</p>
<ol style="list-style-type: decimal">
<li><p>Fit a regression model for <span class="math inline">\(P(A|M,C)\)</span> and obtain <span class="math inline">\(\frac{P(A=0|M=M_i,C=C_i)}{P(A=A_i|M=M_i,C=C_i)}\)</span> for <span class="math inline">\(i=1,...,n\)</span>. This regression model is specified by the <code>ereg</code> argument.</p></li>
<li><p>Fit a regression model for <span class="math inline">\(E(Y|A,C)\)</span>. This regression model is specified by the <code>yreg</code> argument.</p></li>
<li><p>Fit a weighted regression model for <span class="math inline">\(E(Y|A,C)\)</span> and each subject <span class="math inline">\(i\)</span> is given a weight <span class="math inline">\(\frac{P(A=0|M=M_i,C=C_i)}{P(A=A_i|M=M_i,C=C_i)}\)</span>. This regression model is obtained by adding the weights to the regression model in step 2.</p></li>
<li>
<p>Impute the counterfactuals <span class="math inline">\(E_{tot}[Y_{a}]\)</span>, <span class="math inline">\(E_{tot}[Y_{a^*}]\)</span>, <span class="math inline">\(E_{dir}[Y_{a}]\)</span> and <span class="math inline">\(E_{dir}[Y_{a^*}]\)</span>.</p>
<ul>
<li>Impute <span class="math inline">\(E_{tot}[Y_{a}]\)</span> by taking an average of <span class="math inline">\(\{E[Y_i|A=a,C=C_i]\}_{i=1,...,n}\)</span> obtained from the regression model in step 2.</li>
<li>Impute <span class="math inline">\(E_{tot}[Y_{a^*}]\)</span> by taking an average of <span class="math inline">\(\{E[Y_i|A=a^*,C=C_i]\}_{i=1,...,n}\)</span> obtained from the regression model in step 2.</li>
<li>Impute <span class="math inline">\(E_{dir}[Y_{a}]\)</span> by taking a weighted average of <span class="math inline">\(\{E[Y_i|A=a,C=C_i]\}_{i=1,...,n}\)</span> obtained from the regression model in step 3 and each subject <span class="math inline">\(i\)</span> is given a weight <span class="math inline">\(\frac{P(A=0|M=M_i,C=C_i)}{P(A=A_i|M=M_i,C=C_i)}\)</span>.</li>
<li>Impute <span class="math inline">\(E_{dir}[Y_{a^*}]\)</span> by taking a weighted average of <span class="math inline">\(\{E[Y_i|A=a^*,C=C_i]\}_{i=1,...,n}\)</span> obtained from the regression model in step 3 and each subject <span class="math inline">\(i\)</span> is given a weight <span class="math inline">\(\frac{P(A=0|M=M_i,C=C_i)}{P(A=A_i|M=M_i,C=C_i)}\)</span>.</li>
</ul>
</li>
<li><ul>
<li>For a continuous outcome, calculate <span class="math inline">\(TE\)</span> by <span class="math inline">\(E_{tot}[Y_{a}]-E_{tot}[Y_{a^*}]\)</span>, calculate <span class="math inline">\(PNDE\)</span> by <span class="math inline">\(E_{dir}[Y_{a}]-E_{dir}[Y_{a^*}]\)</span> and calculate <span class="math inline">\(TNIE\)</span> by <span class="math inline">\(TE-PNDE\)</span>.</li>
<li>For a categorical, count or survival outcome, calculate <span class="math inline">\(TE\)</span> by <span class="math inline">\(E_{tot}[Y_{a}]/E_{tot}[Y_{a^*}]\)</span>, calculate <span class="math inline">\(PNDE\)</span> by <span class="math inline">\(E_{dir}[Y_{a}]/E_{dir}[Y_{a^*}]\)</span> and calculate <span class="math inline">\(TNIE\)</span> by <span class="math inline">\(TE/PNDE\)</span>.</li>
</ul></li>
</ol>
</div>
<div id="the-natural-effect-model" class="section level2">
<h2 class="hasAnchor">
<a href="#the-natural-effect-model" class="anchor"></a>The Natural Effect Model</h2>
<p>With the natural effect model, <code>CMAverse</code> estimates causal effects through direct counterfactual imputation estimation by the following steps:</p>
<ol style="list-style-type: decimal">
<li><p>Fit a regression model for <span class="math inline">\(E(Y|A,M,C)\)</span>. This regression model is specified by the <code>yreg</code> argument.</p></li>
<li><p>Expand the dataset using the regression model in step 1 and the <code>neImpute</code> function in the <code>medflex</code> package. The expanded dataset gives <span class="math inline">\(A0\)</span> for the direct effect and <span class="math inline">\(A1\)</span> for the indirect effect.</p></li>
<li><p>Fit the regression model in step 1 by the expanded dataset in step 2 with the exposure in the regression formula replaced by <span class="math inline">\(A0\)</span> and mediators in the regression formula replaced by <span class="math inline">\(A1\)</span>, i.e., <span class="math inline">\(Y\sim A0+A1+A0*A1+C\)</span> if the regression formula in step 1 is <span class="math inline">\(Y\sim A+M_1+M_2+A*M_1+C\)</span>.</p></li>
<li><p>For <span class="math inline">\(i=1,...,n\)</span>, obtain <span class="math inline">\(E[Y_i|A=a^*,M=m,C=C_i]\)</span> and <span class="math inline">\(E[Y_i|A=a,M=m,C=C_i]\)</span> from the regression model in step 1; obtain <span class="math inline">\(E[Y_i|A0=a^*,A1=a^*,C=C_i]\)</span>, <span class="math inline">\(E[Y_i|A0=a^*,A1=a,C=C_i]\)</span>, <span class="math inline">\(E[Y_i|A0=a,A1=a^*,C=C_i]\)</span> and <span class="math inline">\(E[Y_i|A0=a,A1=a,C=C_i]\)</span> from the regression model in step 3.</p></li>
<li>
<p>Impute the counterfactuals <span class="math inline">\(E[Y_{a^*m}]\)</span>, <span class="math inline">\(E[Y_{am}]\)</span>, <span class="math inline">\(E[Y_{a^*Ma^*}]\)</span>, <span class="math inline">\(E[Y_{aMa}]\)</span>, <span class="math inline">\(E[Y_{aMa^*}]\)</span> and <span class="math inline">\(E[Y_{a^*Ma}]\)</span>.</p>
<ul>
<li>Impute <span class="math inline">\(E[Y_{a^*m}]\)</span> by taking an average of <span class="math inline">\(\{E[Y_i|A=a^*,M=m,C=C_i]\}_{i=1,...,n}\)</span>.</li>
<li>Impute <span class="math inline">\(E[Y_{am}]\)</span> by taking an average of <span class="math inline">\(\{E[Y_i|A=a,M=m,C=C_i]\}_{i=1,...,n}\)</span>.</li>
<li>Impute <span class="math inline">\(E[Y_{a^*Ma^*}]\)</span> by taking an average of <span class="math inline">\(\{E[Y_i|A0=a^*,A1=a^*,C=C_i]\}_{i=1,...,n}\)</span>.</li>
<li>Impute <span class="math inline">\(E[Y_{aMa}]\)</span> by taking an average of <span class="math inline">\(\{E[Y_i|A0=a,A1=a,C=C_i]\}_{i=1,...,n}\)</span>.</li>
<li>Impute <span class="math inline">\(E[Y_{aMa^*}]\)</span> by taking an average of <span class="math inline">\(\{E[Y_i|A0=a,A1=a^*,C=C_i]\}_{i=1,...,n}\)</span>.</li>
<li>Impute <span class="math inline">\(E[Y_{a^*Ma}]\)</span> by taking an average of <span class="math inline">\(\{E[Y_i|A0=a^*,A1=a,C=C_i]\}_{i=1,...,n}\)</span>.</li>
</ul>
</li>
<li><p>Calculate causal effects with formulas in table 1 or table 2.</p></li>
</ol>
</div>
<div id="the-multistate-approach-for-stochastic-interventions-on-a-time-to-event-mediator-in-the-presence-of-semi-competing-risks" class="section level2">
<h2 class="hasAnchor">
<a href="#the-multistate-approach-for-stochastic-interventions-on-a-time-to-event-mediator-in-the-presence-of-semi-competing-risks" class="anchor"></a>The multistate approach for stochastic interventions on a time-to-event mediator in the presence of semi-competing risks</h2>
<p>In multistate model, there are 3 stages as following graph:</p>
<p><img src="../docs/multistate.png" style="width:50.0%"></p>
<p>We consider survival difference across exposure under an intervention that fixes the mediator distribution in both exposure groups as “Residual disparity” (<span class="math inline">\(RD\)</span>) <span class="math display">\[RD=P(S_g&gt;s|A=1,C) - P(S_g&gt;s|A=0,C)\]</span> We can also consider causal contrasts within an exposure group considering fixed or stochastic interventions, <span class="math inline">\(g\)</span> and <span class="math inline">\(g^*\)</span> on the intermediate time-to-event as “Shifting Distribution effect” (<span class="math inline">\(SDE\)</span>), where <span class="math inline">\(g\)</span> is a random draw from the time to mediator event distribution observed among individuals with <span class="math inline">\(A\)</span> in reference level, controlling all confounders. <span class="math inline">\(g^*\)</span> is a random draw from the time to mediator event distribution observed among individuals with <span class="math inline">\(A\)</span> in alternative level, controlling all confounders. <span class="math display">\[SDE=P(S_{g^*}&gt;s|A=1,C) - P(S_g&gt;s|A=1,C)\]</span> So the “Total Effects” (<span class="math inline">\(TE\)</span>) is defined as survival difference across esposure. <span class="math display">\[TE = P(S&gt;s|A=1,C) - P(S&gt;s|A=0,C)\]</span></p>
<div id="identifiability-conditions" class="section level3">
<h3 class="hasAnchor">
<a href="#identifiability-conditions" class="anchor"></a>Identifiability conditions</h3>
<p>Several assumptions must be met to identify these causal contrasts involving the potential survival time, <span class="math inline">\(S_g\)</span>, under a fixed or stochastic intervention <span class="math inline">\(g\)</span> on an intermediate time-to-event variable.</p>
<ul>
<li>Assumption 1. Consistency of potential outcomes.</li>
</ul>
<p>Let <span class="math inline">\(S_i|T_i = t\)</span> denote the survival time of individual <span class="math inline">\(i\)</span> given that this subject is observed to mediator at time <span class="math inline">\(t\)</span> and let <span class="math inline">\(S_{i,g=t}\)</span> denote the potential survival time for subject <span class="math inline">\(i\)</span> had we intervened setting the mediator time equal to <span class="math inline">\(t\)</span>. For each subject <span class="math inline">\(i\)</span> and each level of time to mediatoe event <span class="math inline">\(T=t\)</span> we assume <span class="math display">\[S_{i,g=t} = S_i|T_i = t\]</span></p>
<ul>
<li>Assumption 2. Conditional exchangeability (no unmeasured confounding).</li>
</ul>
<p>The observed time-to-mediator-event assignment does not depend on the potential outcomes after accounting for the set of measured covariates <span class="math inline">\(A\)</span> and <span class="math inline">\(C\)</span>. <span class="math display">\[S_g   \perp T|A,C = t\]</span></p>
<ul>
<li>Assumption 3. Non-informative censoring of event times.</li>
</ul>
<p>The vector of censoring times <span class="math inline">\(K\)</span> is conditionally independent of all potential event times (which implies that the observed censoring time is conditionally independent of all potential event times). <span class="math display">\[S_g   \perp K|A,C = t\]</span></p>
<ul>
<li>Assumption 4. Assume that positivity holds. That is each covariates’ pattern (<span class="math inline">\(A, C\)</span>) that has positive probability in the data, such that the joint density <span class="math inline">\(f(A,C) &gt;0\)</span> is positive, the probability of time to mediator event (fixed or stochastic) intervention <span class="math inline">\(g=t\)</span> is positive with probability 1.</li>
</ul>
</div>
<div id="estimators-under-a-multistate-model-representation" class="section level3">
<h3 class="hasAnchor">
<a href="#estimators-under-a-multistate-model-representation" class="anchor"></a>Estimators under a multistate model representation</h3>
<p>The multistate model is a natural frame work to operationalize the nonparametric estimator. Our setting involves the following scenarios: (1) the individual transits from <span class="math inline">\(A\)</span> to <span class="math inline">\(M\)</span>, and then possibly from <span class="math inline">\(M\)</span> to <span class="math inline">\(Y\)</span> or (2) the individual transits from <span class="math inline">\(A\)</span> directly to <span class="math inline">\(Y\)</span> and time to <span class="math inline">\(M\)</span> is censored at time of <span class="math inline">\(Y\)</span> or (3) the individual is censored before the intermediate and the terminal event occur or (4) the individual is censored after the intermediate event oxxurs and prior the terminal event occurs. We define <span class="math inline">\(\alpha_{01}(t|A,C)\)</span>, <span class="math inline">\(\alpha_{02}(t|A,C)\)</span> and <span class="math inline">\(\alpha_{12}(t|A,C)\)</span> as the instantaneous hazard of transition from <span class="math inline">\(A\)</span> to <span class="math inline">\(M\)</span>, from <span class="math inline">\(A\)</span> to <span class="math inline">\(Y\)</span>, and from <span class="math inline">\(M\)</span> to <span class="math inline">\(Y\)</span>, respectively.<span class="math inline">\(\Lambda_{01}\)</span>, <span class="math inline">\(\Lambda_{02}\)</span> and <span class="math inline">\(\Lambda_{12}\)</span> are the corresponding cumulative transition. <span class="math inline">\(P(S&gt;s|A,C)\)</span> is the sum of the <span class="math inline">\(P_{00}(s|A,C)\)</span> and <span class="math inline">\(P_{01}(s|A,C)\)</span>, where <span class="math display">\[P_{00}(s|A,C) = e^{-\Lambda_{01}(s|A,C)-\Lambda_{02}(s|A,C)}\]</span> and <span class="math display">\[P_{01}(s|A,C) = \int_0^s {e^{-\Lambda_{01}(t|A,C)-\Lambda_{02}(t|A,C)}\alpha_{01}e^{-\Lambda_{12}(s|T=t,A,C)+\Lambda_{12}(t|T=t,A,C)}}\,{\rm d}t\]</span></p>
<p>Let <span class="math inline">\(g = G(T_c)(0)\)</span> be a random draw from the time to mediator event distribution in the reference group <span class="math inline">\(A = 0\)</span>. <span class="math display">\[P(S_g&gt;s|A=1,C)=P_{00}^g(s|A,C)+P_{01}^g(s|A,C) \\ = e^{-\Lambda_{01}(s|A=0,C)-\Lambda_{02}(s|A=1,C)} + \int_0^s {e^{-\Lambda_{01}(t|A=0,C)-\Lambda_{02}(t|A=1,C)}\alpha_{01(}(t|A=0,C)e^{-\Lambda_{12}(s|T=t,A=1,C)+\Lambda_{12}(t|T=t,A=1,C)}}\,{\rm d}t\]</span></p>
</div>
<div id="methods" class="section level3">
<h3 class="hasAnchor">
<a href="#methods" class="anchor"></a>Methods</h3>
<p>With the multistate model, <code>CMAverse</code> estimates causal effects through direct counterfactual imputation estimation by the following steps:</p>
<ol style="list-style-type: decimal">
<li>Fit a multistate model with all variables of interest. The formula of model could be generated by <code>cmest</code> argument or specified by the user with a format as <span class="math display">\[Surv(Tstart, Tstop, status)\text{ ~ }\beta_{1.1}^{'}A.1+\beta_{1.2}^{'}A.2+\beta_{1.3}^{'}A.3+ \beta_{2.1}^{'}*C.1 +\beta_{2.2}^{'}*C.2 +\beta_{2.3}^{'}*C.3 + \beta_{3}^{'}*A.3*M.3 + \beta_4*M.3 + strata(trans)\]</span>
</li>
<li>Estimate semi-parametric proportional intensity model for the hazard of transitions by the following function: <span class="math display">\[\alpha_{01}(t|A,C)=\alpha_{01}^{0}(t)e^{\beta_{1.1}^{'}*A.1+\beta_{2.1}^{'}*C.1}\]</span>
</li>
</ol>
<p><span class="math display">\[\alpha_{02}(t|A,C)=\alpha_{02}^{0}(t)e^{\beta_{1.2}^{'}*A.2+\beta_{2.2}^{'}*C.2}\]</span></p>
<p><span class="math display">\[\alpha_{12}(t|M,A,C)=\alpha_{12}^{0}(t)e^{\beta_{1.3}^{'}A.3+\beta_4*M.3+\beta_{3}^{'}*A.3*M.3+\beta_{2.3}^{'}*C.3}\]</span></p>
<ol start="3" style="list-style-type: decimal">
<li>Estimate <span class="math inline">\(P(S&gt;s|A,C)\)</span>, <span class="math inline">\(P(S_g&gt;s|A,C)\)</span>, <span class="math inline">\(P(S_{g^*}&gt;s|A=1,C)\)</span> by the following function: <span class="math display">\[P(S&gt;s|A,C) = e^{-\int_0^s{\alpha_{01}(t)e^{\beta_{1.1}^{'}*A.1+\beta_{2.1}^{'}*C.1}}\,{\rm d}t-\int_0^s{\alpha_{02}(t)e^{\beta_{1.2}^{'}*A.2+\beta_{2.2}^{'}*C.2}}\,{\rm d}t} \\ + \int_0^s{e^{-\int_0^t{\alpha_{01}(t)e^{\beta_{1.1}^{'}*A.1+\beta_{2.1}^{'}*C.1}}\,{\rm d}t-\int_0^t{\alpha_{02}(t)e^{\beta_{1.2}^{'}*A.2+\beta_{2.2}^{'}*C.2}}\,{\rm d}t}\alpha_{01}(t)e^{-\int_0^s{\alpha_{12}(t)e^{\beta_{1.3}^{'}A.3+\beta_4*M.3+\beta_{3}^{'}*A.3*M.3+\beta_{2.3}^{'}*C.3}\,{\rm d}t}+\int_0^t{\alpha_{12}(t)e^{\beta_{1.3}^{'}A.3+\beta_4*M.3+\beta_{3}^{'}*A.3*M.3+\beta_{2.3}^{'}*C.3}}\,{\rm d}t}}\,{\rm d}t\]</span> <span class="math display">\[P(S_g&gt;s|A=1,C) = e^{-\int_0^s{\alpha_{01}(t|A=0)e^{\beta_{1.1}^{'}*0+\beta_{2.1}^{'}*C.1}}\,{\rm d}t-\int_0^s{\alpha_{02}(t)e^{\beta_{1.2}^{'}*A.2+\beta_{2.2}^{'}*C.2}}\,{\rm d}t} \\ + \int_0^s{e^{-\int_0^t{\alpha_{01}(t|A=0)e^{\beta_{1.1}^{'}*0+\beta_{2.1}^{'}*C.1}}\,{\rm d}t-\int_0^t{\alpha_{02}(t)e^{\beta_{1.2}^{'}*A.2+\beta_{2.2}^{'}*C.2}}\,{\rm d}t}\alpha_{01}(t|A=0)e^{-\int_0^s{\alpha_{12}(t)e^{\beta_{1.3}^{'}A.3+\beta_4*M.3+\beta_{3}^{'}*A.3*M.3+\beta_{2.3}^{'}*C.3}\,{\rm d}t}+\int_0^t{\alpha_{12}(t)e^{\beta_{1.3}^{'}A.3+\beta_4*M.3+\beta_{3}^{'}*A.3*M.3+\beta_{2.3}^{'}*C.3}}\,{\rm d}t}}\,{\rm d}t\]</span> <span class="math display">\[P(S_g&gt;s|A=0,C) = P(S&gt;s|A=0,C)\]</span> <span class="math display">\[P(S_{g^*}&gt;s|A=1,C) = P(S&gt;s|A=1,C)\]</span>
</li>
<li>Estimate <span class="math inline">\(TE\)</span>, <span class="math inline">\(RD\)</span> and <span class="math inline">\(SD\)</span> by the following survival function:
<ul>
<li><span class="math inline">\(TE=P(S&gt;s|A=1,C) - P(S&gt;s|A=0,C)\)</span></li>
<li><span class="math inline">\(RD=P(S_g&gt;s|A=1,C) - P(S_g&gt;s|A=0,C)\)</span></li>
<li><span class="math inline">\(SD=P(S_{g^*}&gt;s|A=1,C) - P(S_g&gt;s|A=1,C)\)</span></li>
</ul>
</li>
<li>Conduct boostrapping and calculate mean of <span class="math inline">\(TE\)</span>, <span class="math inline">\(RD\)</span> and <span class="math inline">\(SDE\)</span>.</li>
</ol>
</div>
</div>
</div>
<div id="confounders-affected-by-the-exposure" class="section level1">
<h1 class="hasAnchor">
<a href="#confounders-affected-by-the-exposure" class="anchor"></a>Confounders Affected by the exposure</h1>
<div id="dag-1" class="section level2">
<h2 class="hasAnchor">
<a href="#dag-1" class="anchor"></a>DAG</h2>
<p><img src="overview_files/figure-html/unnamed-chunk-5-1.png" width="576"></p>
</div>
<div id="estimands-1" class="section level2">
<h2 class="hasAnchor">
<a href="#estimands-1" class="anchor"></a>Estimands</h2>
<p>For a continuous outcome, causal effects are estimated on the difference scale (summarized in table 3). For a categorical, count, or survival outcome, causal effects are estimated on the ratio scale (summarized in table 4). Because of the existence of <span class="math inline">\(L\)</span>, some causal effects in table 1 and table 2 are not identifiable. However, their randomized analogues are still identifiable. See <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC4214081/">VanderWeele et al. (2014)</a> for details about randomized analogues of causal effects.</p>
<table class="table table table-bordered table-striped table-hover table-responsive table-condensed">
<caption>
Table 3: Causal Effects on the Difference Scale
</caption>
<thead><tr>
<th style="text-align:left;">
Full Name
</th>
<th style="text-align:left;">
Abbreviation
</th>
<th style="text-align:left;">
Formula
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;width: 20em; ">
Controlled Direct Effect
</td>
<td style="text-align:left;width: 8em; ">
<span class="math inline">\(CDE\)</span>
</td>
<td style="text-align:left;width: 10em; ">
<span class="math inline">\(E[Y_{am}-Y_{a^*m}]\)</span>
</td>
</tr>
<tr>
<td style="text-align:left;width: 20em; ">
Randomized Analogue of <span class="math inline">\(PNDE\)</span>
</td>
<td style="text-align:left;width: 8em; ">
<span class="math inline">\(rPNDE\)</span>
</td>
<td style="text-align:left;width: 10em; ">
<span class="math inline">\(E[Y_{aG_{a^*}}-Y_{a^*G_{a^*}}]\)</span>
</td>
</tr>
<tr>
<td style="text-align:left;width: 20em; ">
Randomized Analogue of <span class="math inline">\(TNDE\)</span>
</td>
<td style="text-align:left;width: 8em; ">
<span class="math inline">\(rTNDE\)</span>
</td>
<td style="text-align:left;width: 10em; ">
<span class="math inline">\(E[Y_{aG_{a}}-Y_{a^*G_{a}}]\)</span>
</td>
</tr>
<tr>
<td style="text-align:left;width: 20em; ">
Randomized Analogue of <span class="math inline">\(PNIE\)</span>
</td>
<td style="text-align:left;width: 8em; ">
<span class="math inline">\(rPNIE\)</span>
</td>
<td style="text-align:left;width: 10em; ">
<span class="math inline">\(E[Y_{a^*G_{a}}-Y_{a^*G_{a^*}}]\)</span>
</td>
</tr>
<tr>
<td style="text-align:left;width: 20em; ">
Randomized Analogue of <span class="math inline">\(TNIE\)</span>
</td>
<td style="text-align:left;width: 8em; ">
<span class="math inline">\(rTNIE\)</span>
</td>
<td style="text-align:left;width: 10em; ">
<span class="math inline">\(E[Y_{aG_{a}}-Y_{aG_{a^*}}]\)</span>
</td>
</tr>
<tr>
<td style="text-align:left;width: 20em; ">
Total Effect
</td>
<td style="text-align:left;width: 8em; ">
<span class="math inline">\(TE\)</span>
</td>
<td style="text-align:left;width: 10em; ">
<span class="math inline">\(rPNDE+rTNIE\)</span> or <span class="math inline">\(rTNDE+rPNIE\)</span>
</td>
</tr>
<tr>
<td style="text-align:left;width: 20em; ">
Randomized Analogue of <span class="math inline">\(INT_{ref}\)</span>
</td>
<td style="text-align:left;width: 8em; ">
<span class="math inline">\(rINT_{ref}\)</span>
</td>
<td style="text-align:left;width: 10em; ">
<span class="math inline">\(rPNDE-CDE\)</span>
</td>
</tr>
<tr>
<td style="text-align:left;width: 20em; ">
Randomized Analogue of <span class="math inline">\(INT_{med}\)</span>
</td>
<td style="text-align:left;width: 8em; ">
<span class="math inline">\(rINT_{med}\)</span>
</td>
<td style="text-align:left;width: 10em; ">
<span class="math inline">\(rTNIE-rPNIE\)</span>
</td>
</tr>
<tr>
<td style="text-align:left;width: 20em; ">
Proportion <span class="math inline">\(CDE\)</span>
</td>
<td style="text-align:left;width: 8em; ">
<span class="math inline">\(prop^{CDE}\)</span>
</td>
<td style="text-align:left;width: 10em; ">
<span class="math inline">\(CDE/TE\)</span>
</td>
</tr>
<tr>
<td style="text-align:left;width: 20em; ">
Proportion <span class="math inline">\(rINT_{ref}\)</span>
</td>
<td style="text-align:left;width: 8em; ">
<span class="math inline">\(prop^{rINT_{ref}}\)</span>
</td>
<td style="text-align:left;width: 10em; ">
<span class="math inline">\(rINT_{ref}/TE\)</span>
</td>
</tr>
<tr>
<td style="text-align:left;width: 20em; ">
Proportion <span class="math inline">\(rINT_{med}\)</span>
</td>
<td style="text-align:left;width: 8em; ">
<span class="math inline">\(prop^{rINT_{med}}\)</span>
</td>
<td style="text-align:left;width: 10em; ">
<span class="math inline">\(rINT_{med}/TE\)</span>
</td>
</tr>
<tr>
<td style="text-align:left;width: 20em; ">
Proportion <span class="math inline">\(rPNIE\)</span>
</td>
<td style="text-align:left;width: 8em; ">
<span class="math inline">\(prop^{rPNIE}\)</span>
</td>
<td style="text-align:left;width: 10em; ">
<span class="math inline">\(rPNIE/TE\)</span>
</td>
</tr>
<tr>
<td style="text-align:left;width: 20em; ">
Randomized Analogue of <span class="math inline">\(PM\)</span>
</td>
<td style="text-align:left;width: 8em; ">
<span class="math inline">\(rPM\)</span>
</td>
<td style="text-align:left;width: 10em; ">
<span class="math inline">\(rTNIE/TE\)</span>
</td>
</tr>
<tr>
<td style="text-align:left;width: 20em; ">
Randomized Analogue of <span class="math inline">\(INT\)</span>
</td>
<td style="text-align:left;width: 8em; ">
<span class="math inline">\(rINT\)</span>
</td>
<td style="text-align:left;width: 10em; ">
<span class="math inline">\((rINT_{ref}+rINT_{med})/TE\)</span>
</td>
</tr>
<tr>
<td style="text-align:left;width: 20em; ">
Randomized Analogue of <span class="math inline">\(PE\)</span>
</td>
<td style="text-align:left;width: 8em; ">
<span class="math inline">\(rPE\)</span>
</td>
<td style="text-align:left;width: 10em; ">
<span class="math inline">\((rINT_{ref}+rINT_{med}+rPNIE)/TE\)</span>
</td>
</tr>
</tbody>
<tfoot>
<tr>
<td style="padding: 0; " colspan="100%">
<span style="font-style: italic;">Note: </span>
</td>
</tr>
<tr>
<td style="padding: 0; " colspan="100%">
<sup></sup><span class="math inline">\(a\)</span> and <span class="math inline">\(a^*\)</span> are the active and control values for <span class="math inline">\(A\)</span>. <span class="math inline">\(m\)</span> is the value at which <span class="math inline">\(M\)</span> is controlled. <span class="math inline">\(G_{a}\)</span> denotes a random draw from the distribution of <span class="math inline">\(M\)</span> had <span class="math inline">\(A=a\)</span>. <span class="math inline">\(Y_{am}\)</span> denotes the counterfactual value of <span class="math inline">\(Y\)</span> that would have been observed had <span class="math inline">\(A\)</span> been set to be <span class="math inline">\(a\)</span>, and <span class="math inline">\(M\)</span> to be <span class="math inline">\(m\)</span>. <span class="math inline">\(Y_{aG_{a*}}\)</span> denotes the counterfactual value of <span class="math inline">\(Y\)</span> that would have been observed had <span class="math inline">\(A\)</span> been set to be <span class="math inline">\(a\)</span>, and <span class="math inline">\(M\)</span> to be the counterfactual value <span class="math inline">\(G_{a*}\)</span>.
</td>
</tr>
</tfoot>
</table>
<table class="table table table-bordered table-striped table-hover table-responsive">
<caption>
Table 4: Causal Effects on the Ratio Scale
</caption>
<thead><tr>
<th style="text-align:left;">
Full Name
</th>
<th style="text-align:left;">
Abbreviation
</th>
<th style="text-align:left;">
Formula
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;width: 20em; ">
Controlled Direct Effect
</td>
<td style="text-align:left;width: 8em; ">
<span class="math inline">\(R^{CDE}\)</span>
</td>
<td style="text-align:left;width: 10em; ">
<span class="math inline">\(E[Y_{am}]/E[Y_{a^*m}]\)</span>
</td>
</tr>
<tr>
<td style="text-align:left;width: 20em; ">
Randomized Analogue of <span class="math inline">\(PNDE\)</span>
</td>
<td style="text-align:left;width: 8em; ">
<span class="math inline">\(rR^{PNDE}\)</span>
</td>
<td style="text-align:left;width: 10em; ">
<span class="math inline">\(E[Y_{aG_{a^*}}]/E[Y_{a^*G_{a^*}}]\)</span>
</td>
</tr>
<tr>
<td style="text-align:left;width: 20em; ">
Randomized Analogue of <span class="math inline">\(TNDE\)</span>
</td>
<td style="text-align:left;width: 8em; ">
<span class="math inline">\(rR^{TNDE}\)</span>
</td>
<td style="text-align:left;width: 10em; ">
<span class="math inline">\(E[Y_{aG_{a}}]/E[Y_{a^*G_{a}}]\)</span>
</td>
</tr>
<tr>
<td style="text-align:left;width: 20em; ">
Randomized Analogue of <span class="math inline">\(PNIE\)</span>
</td>
<td style="text-align:left;width: 8em; ">
<span class="math inline">\(rR^{PNIE}\)</span>
</td>
<td style="text-align:left;width: 10em; ">
<span class="math inline">\(E[Y_{a^*G_{a}}]/E[Y_{a^*G_{a^*}}]\)</span>
</td>
</tr>
<tr>
<td style="text-align:left;width: 20em; ">
Randomized Analogue of <span class="math inline">\(TNIE\)</span>
</td>
<td style="text-align:left;width: 8em; ">
<span class="math inline">\(rR^{TNIE}\)</span>
</td>
<td style="text-align:left;width: 10em; ">
<span class="math inline">\(E[Y_{aG_{a}}]/E[Y_{aG_{a^*}}]\)</span>
</td>
</tr>
<tr>
<td style="text-align:left;width: 20em; ">
Total Effect
</td>
<td style="text-align:left;width: 8em; ">
<span class="math inline">\(R^{TE}\)</span>
</td>
<td style="text-align:left;width: 10em; ">
<span class="math inline">\(rR^{PNDE}\times rR^{TNIE}\)</span> or <span class="math inline">\(rR^{TNDE}\times rR^{PNIE}\)</span>
</td>
</tr>
<tr>
<td style="text-align:left;width: 20em; ">
Excess Ratio due to Controlled Direct Effect
</td>
<td style="text-align:left;width: 8em; ">
<span class="math inline">\(ER^{CDE}\)</span>
</td>
<td style="text-align:left;width: 10em; ">
<span class="math inline">\((E[Y_{am}-Y_{a^*m}])/E[Y_{a^*M_a^*}]\)</span>
</td>
</tr>
<tr>
<td style="text-align:left;width: 20em; ">
Randomized Analogue of <span class="math inline">\(ER^{INT_{ref}}\)</span>
</td>
<td style="text-align:left;width: 8em; ">
<span class="math inline">\(rER^{INT_{ref}}\)</span>
</td>
<td style="text-align:left;width: 10em; ">
<span class="math inline">\(rR^{PNDE}-1-ER^{CDE}\)</span>
</td>
</tr>
<tr>
<td style="text-align:left;width: 20em; ">
Randomized Analogue of <span class="math inline">\(ER^{INT_{med}}\)</span>
</td>
<td style="text-align:left;width: 8em; ">
<span class="math inline">\(rER^{INT_{med}}\)</span>
</td>
<td style="text-align:left;width: 10em; ">
<span class="math inline">\(rR^{TNIE}*rR^{PNDE}-rR^{PNDE}-rR^{PNIE}+1\)</span>
</td>
</tr>
<tr>
<td style="text-align:left;width: 20em; ">
Randomized Analogue of <span class="math inline">\(ER^{PNIE}\)</span>
</td>
<td style="text-align:left;width: 8em; ">
<span class="math inline">\(rER^{PNIE}\)</span>
</td>
<td style="text-align:left;width: 10em; ">
<span class="math inline">\(rR^{PNIE}-1\)</span>
</td>
</tr>
<tr>
<td style="text-align:left;width: 20em; ">
Proportion <span class="math inline">\(ER^{CDE}\)</span>
</td>
<td style="text-align:left;width: 8em; ">
<span class="math inline">\(prop^{ER^{CDE}}\)</span>
</td>
<td style="text-align:left;width: 10em; ">
<span class="math inline">\(ER^{CDE}/(rR^{TE}-1)\)</span>
</td>
</tr>
<tr>
<td style="text-align:left;width: 20em; ">
Proportion <span class="math inline">\(rER^{INT_{ref}}\)</span>
</td>
<td style="text-align:left;width: 8em; ">
<span class="math inline">\(prop^{rER^{INT_{ref}}}\)</span>
</td>
<td style="text-align:left;width: 10em; ">
<span class="math inline">\(rER^{INT_{ref}}/(R^{TE}-1)\)</span>
</td>
</tr>
<tr>
<td style="text-align:left;width: 20em; ">
Proportion <span class="math inline">\(rER^{INT_{med}}\)</span>
</td>
<td style="text-align:left;width: 8em; ">
<span class="math inline">\(prop^{rER^{INT_{med}}}\)</span>
</td>
<td style="text-align:left;width: 10em; ">
<span class="math inline">\(rER^{INT_{med}}/(R^{TE}-1)\)</span>
</td>
</tr>
<tr>
<td style="text-align:left;width: 20em; ">
Proportion <span class="math inline">\(rER^{PNIE}\)</span>
</td>
<td style="text-align:left;width: 8em; ">
<span class="math inline">\(prop^{rER^{PNIE}}\)</span>
</td>
<td style="text-align:left;width: 10em; ">
<span class="math inline">\(rER^{PNIE}/(R^{TE}-1)\)</span>
</td>
</tr>
<tr>
<td style="text-align:left;width: 20em; ">
Randomized Analogue of <span class="math inline">\(PM\)</span>
</td>
<td style="text-align:left;width: 8em; ">
<span class="math inline">\(rPM\)</span>
</td>
<td style="text-align:left;width: 10em; ">
<span class="math inline">\((rR^{PNDE}*(rR^{TNIE}-1))/(R^{TE}-1)\)</span>
</td>
</tr>
<tr>
<td style="text-align:left;width: 20em; ">
Randomized Analogue of <span class="math inline">\(INT\)</span>
</td>
<td style="text-align:left;width: 8em; ">
<span class="math inline">\(rINT\)</span>
</td>
<td style="text-align:left;width: 10em; ">
<span class="math inline">\((rER^{INT_{ref}}+rER^{INT_{med}})/(R^{TE}-1)\)</span>
</td>
</tr>
<tr>
<td style="text-align:left;width: 20em; ">
Randomized Analogue of <span class="math inline">\(PE\)</span>
</td>
<td style="text-align:left;width: 8em; ">
<span class="math inline">\(rPE\)</span>
</td>
<td style="text-align:left;width: 10em; ">
<span class="math inline">\((rER^{INT_{ref}}+rER^{INT_{med}}+rER^{PNIE})/(R^{TE}-1)\)</span>
</td>
</tr>
</tbody>
<tfoot>
<tr>
<td style="padding: 0; " colspan="100%">
<span style="font-style: italic;">Note: </span>
</td>
</tr>
<tr>
<td style="padding: 0; " colspan="100%">
<sup></sup><span class="math inline">\(a\)</span> and <span class="math inline">\(a^*\)</span> are the active and control values for <span class="math inline">\(A\)</span>. <span class="math inline">\(m\)</span> is the value at which <span class="math inline">\(M\)</span> is controlled. <span class="math inline">\(G_{a}\)</span> denotes a random draw from the distribution of <span class="math inline">\(M\)</span> among those with <span class="math inline">\(A=a\)</span>. <span class="math inline">\(Y_{am}\)</span> denotes the counterfactual value of <span class="math inline">\(Y\)</span> that would have been observed had <span class="math inline">\(A\)</span> been set to be <span class="math inline">\(a\)</span>, and <span class="math inline">\(M\)</span> to be <span class="math inline">\(m\)</span>. <span class="math inline">\(Y_{aG_{a*}}\)</span> denotes the counterfactual value of <span class="math inline">\(Y\)</span> that would have been observed had <span class="math inline">\(A\)</span> been set to be <span class="math inline">\(a\)</span>, and <span class="math inline">\(M\)</span> to be the counterfactual value <span class="math inline">\(G_{a*}\)</span>. If <span class="math inline">\(Y\)</span> is categorical, <span class="math inline">\(E[Y]\)</span> represents the probability of <span class="math inline">\(Y=y\)</span> where <span class="math inline">\(y\)</span> is a pre-specified value of <span class="math inline">\(Y\)</span>.
</td>
</tr>
</tfoot>
</table>
</div>
<div id="the-marginal-structural-model" class="section level2">
<h2 class="hasAnchor">
<a href="#the-marginal-structural-model" class="anchor"></a>The Marginal Structural Model</h2>
<p>With the marginal structural model, <code>CMAverse</code> estimates causal effects through direct counterfactual imputation estimation by the following steps:</p>
<ol style="list-style-type: decimal">
<li><p>For <span class="math inline">\(p=1,...,k\)</span>, fit the regression model specified by <code>wmnomreg[p]</code> for <span class="math inline">\(P(M_p|A,M_1, ...,M_{p-1})\)</span> and obtain <span class="math inline">\(P(M_p=M_{p,i}|A=A_i,M_1=M_{1,i},...,M_{p-1}=M_{p-1,i})\)</span> for <span class="math inline">\(i=1,...,n\)</span>.</p></li>
<li><p>For <span class="math inline">\(p=1,...,k\)</span>, fit the regression model specified by <code>wmdenomreg[p]</code> for <span class="math inline">\(P(M_p|A,M_1, ...,M_{p-1},L,C)\)</span> and obtain <span class="math inline">\(P(M_p=M_{p,i}|A=A_i,M_1=M_{1,i},...,M_{p-1}=M_{p-1,i},L=L_i,C=C_i)\)</span> for <span class="math inline">\(i=1,...,n\)</span>.</p></li>
<li><p>If <span class="math inline">\(C\)</span> is not empty, fit the regression model specified by <code>ereg</code> for <span class="math inline">\(P(A|C)\)</span> and obtain <span class="math inline">\(P(A=A_i|C=C_i)\)</span> for <span class="math inline">\(i=1,...,n\)</span>.</p></li>
<li><p>Add weights to the regression model specified by <code>yreg</code> for <span class="math inline">\(E(Y|A,M)\)</span> and each subject <span class="math inline">\(i,i=1,...,n\)</span> is given a weight <span class="math inline">\(\frac{P(A=A_i)}{P(A=A_i|C=C_i)}\frac{P(M_1=M_{1,i}|A=A_i)}{P(M_1=M_{1,i}|A=A_i,C=C_i,L=L_i)}...\frac{P(M_k=M_{k,i}|A=A_i,M_1=M_{1,i},...,M_{k-1}=M_{k-1,i})}{P(M_k=M_{k,i}|A=A_i,M_1=M_{1,i},...,M_{k-1}=M_{k-1,i},C=C_i,L=L_i)}\)</span>.</p></li>
<li><p>For <span class="math inline">\(p=1,...,k\)</span>, add weights to the regression model specified by <code>mreg[p]</code> for the distribution of <span class="math inline">\(M_p\)</span> given <span class="math inline">\(A\)</span> and each subject <span class="math inline">\(i,i=1,...,n\)</span> is given a weight <span class="math inline">\(\frac{P(A=A_i)}{P(A=A_i|C=C_i)}\)</span>.</p></li>
<li>
<p>For <span class="math inline">\(p=1,...,k\)</span> and <span class="math inline">\(i=1,...,n\)</span>, simulate the counterfactuals <span class="math inline">\(M_{a,p,i}\)</span> and <span class="math inline">\(M_{a^*,p,i}\)</span> from the regression models in step 5.</p>
<ul>
<li>Simulate <span class="math inline">\(M_{a,p,i}\)</span> by randomly drawing a value from the distribution of <span class="math inline">\(M_{p}\)</span> given <span class="math inline">\(A=a\)</span>. Denote <span class="math inline">\(M_{a,i}=(M_{a,1,i},...,M_{a,k,i})^T\)</span>.</li>
<li>Simulate <span class="math inline">\(M_{a^*,p,i}\)</span> by randomly drawing a value from the distribution of <span class="math inline">\(M_{p}\)</span> given <span class="math inline">\(A=a^*\)</span>. Denote <span class="math inline">\(M_{a^*,i}=(M_{a^*,1,i},...,M_{a^*,k,i})^T\)</span>.</li>
</ul>
</li>
<li><p>For <span class="math inline">\(i=1,...,n\)</span>, obtain <span class="math inline">\(E[Y_i|A=a^*,M=m]\)</span>, <span class="math inline">\(E[Y_i|A=a,M=m]\)</span>, <span class="math inline">\(E[Y_i|A=a^*,M=M_{a^*,i}]\)</span>, <span class="math inline">\(E[Y_i|A=a^*,M=M_{a,i}]\)</span>, <span class="math inline">\(E[Y_i|A=a,M=M_{a^*,i}]\)</span> and <span class="math inline">\(E[Y_i|A=a,M=M_{a,i}]\)</span> from the regression model in step 4.</p></li>
<li>
<p>Impute the counterfactuals <span class="math inline">\(E[Y_{a^*m}]\)</span>, <span class="math inline">\(E[Y_{am}]\)</span>, <span class="math inline">\(E[Y_{a^*Ga^*}]\)</span>, <span class="math inline">\(E[Y_{aGa}]\)</span>, <span class="math inline">\(E[Y_{aGa^*}]\)</span> and <span class="math inline">\(E[Y_{a^*Ga}]\)</span>.</p>
<ul>
<li>Impute <span class="math inline">\(E[Y_{a^*m}]\)</span> by taking a weighted average of <span class="math inline">\(\{E[Y_i|A=a^*,M=m]\}_{i=1,...,n}\)</span>;</li>
<li>Impute <span class="math inline">\(E[Y_{am}]\)</span> by taking a weighted average of <span class="math inline">\(\{E[Y_i|A=a,M=m]\}_{i=1,...,n}\)</span>;</li>
<li>Impute <span class="math inline">\(E[Y_{a^*Ga^*}]\)</span> by taking a weighted average of <span class="math inline">\(\{E[Y_i|A=a^*,M=M_{a^*,i}]\}_{i=1,...,n}\)</span>;</li>
<li>Impute <span class="math inline">\(E[Y_{aGa}]\)</span> by taking a weighted average of <span class="math inline">\(\{E[Y_i|A=a,M=M_{a,i}]\}_{i=1,...,n}\)</span>;</li>
<li>Impute <span class="math inline">\(E[Y_{aGa^*}]\)</span> by taking a weighted average of <span class="math inline">\(\{E[Y_i|A=a,M=M_{a^*,i}]\}_{i=1,...,n}\)</span>;</li>
<li>Impute <span class="math inline">\(E[Y_{a^*Ga}]\)</span> by taking a weighted average of <span class="math inline">\(\{E[Y_i|A=a^*,M=M_{a,i}]\}_{i=1,...,n}\)</span>,</li>
</ul>
<p>each subject <span class="math inline">\(i,i=1,...,n\)</span> is given a weight <span class="math inline">\(\frac{P(A=A_i)}{P(A=A_i|C=C_i)}\frac{P(M_1=M_{1,i}|A=A_i)}{P(M_1=M_{1,i}|A=A_i,C=C_i,L=L_i)}...\frac{P(M_k=M_{k,i}|A=A_i,M_1=M_{1,i},...,M_{k-1}=M_{k-1,i})}{P(M_k=M_{k,i}|A=A_i,M_1=M_{1,i},...,M_{k-1}=M_{k-1,i},C=C_i,L=L_i)}\)</span>.</p>
</li>
<li><p>Calculate causal effects with formulas in table 3 or table 4.</p></li>
</ol>
</div>
<div id="the-g-formula-approach" class="section level2">
<h2 class="hasAnchor">
<a href="#the-g-formula-approach" class="anchor"></a>The g-formula Approach</h2>
<p>With the <span class="math inline">\(g\)</span>-formula approach, <code>CMAverse</code> estimates causal effects through direct counterfactual imputation estimation by the following steps:</p>
<ol style="list-style-type: decimal">
<li><p>For <span class="math inline">\(q=1,...,s\)</span>, fit the regression model specified by <code>postcreg[q]</code> for the distribution of <span class="math inline">\(L_q\)</span> given <span class="math inline">\(A\)</span> and <span class="math inline">\(C\)</span>.</p></li>
<li>
<p>For <span class="math inline">\(q=1,...,s\)</span> and <span class="math inline">\(i=1,...,n\)</span>, simulate the counterfactuals <span class="math inline">\(L_{a,q,i}\)</span> and <span class="math inline">\(L_{a^*,q,i}\)</span> from the regression models in step 1.</p>
<ul>
<li>Simulate <span class="math inline">\(L_{a,q,i}\)</span> by randomly drawing a value from the distribution of <span class="math inline">\(L_{q}\)</span> given <span class="math inline">\(A=a,C=C_i\)</span>. Denote <span class="math inline">\(L_{a,i}=(L_{a,1,i},...,L_{a,s,i})^T\)</span>.</li>
<li>Simulate <span class="math inline">\(L_{a^*,q,i}\)</span> by randomly drawing a value from the distribution of <span class="math inline">\(L_{q}\)</span> given <span class="math inline">\(A=a^*,C=C_i\)</span>. Denote <span class="math inline">\(L_{a^*,i}=(L_{a^*,1,i},...,L_{a^*,s,i})^T\)</span>.</li>
</ul>
</li>
<li><p>For <span class="math inline">\(p=1,...,k\)</span>, fit the regression model specified by <code>mreg[p]</code> for the distribution of <span class="math inline">\(M_p\)</span> given <span class="math inline">\(A\)</span>, <span class="math inline">\(L\)</span> and <span class="math inline">\(C\)</span>.</p></li>
<li>
<p>For <span class="math inline">\(p=1,...,k\)</span> and <span class="math inline">\(i=1,...,n\)</span>, simulate the counterfactuals <span class="math inline">\(M_{a,p,i}\)</span> and <span class="math inline">\(M_{a^*,p,i}\)</span> from the regression models in step 3.</p>
<ul>
<li>Simulate <span class="math inline">\(M_{a,p,i}\)</span> by randomly drawing a value from the distribution of <span class="math inline">\(M_{p}\)</span> given <span class="math inline">\(A=a,L=L_{a,i},C=C_i\)</span>. Denote <span class="math inline">\(M_{a,i}=(M_{a,1,i},...,M_{a,k,i})^T\)</span>.</li>
<li>Simulate <span class="math inline">\(M_{a^*,p,i}\)</span> by randomly drawing a value from the distribution of <span class="math inline">\(M_{p}\)</span> given <span class="math inline">\(A=a^*,L=L_{a^*,i},C=C_i\)</span>. Denote <span class="math inline">\(M_{a^*,i}=(M_{a^*,1,i},...,M_{a^*,k,i})^T\)</span>.</li>
</ul>
</li>
<li><p>Obtain <span class="math inline">\(\{G_{a,i}\}_{i=1,...,n}\)</span> by randomly permuting <span class="math inline">\(\{M_{a,i}\}_{i=1,...,n}\)</span> and obtain <span class="math inline">\(\{G_{a^*,i}\}_{i=1,...,n}\)</span> by randomly permuting <span class="math inline">\(\{M_{a^*,i}\}_{i=1,...,n}\)</span>.</p></li>
<li><p>Fit the regression model specified by <code>yreg</code> for <span class="math inline">\(E(Y|A,M,L,C)\)</span>.</p></li>
<li><p>For <span class="math inline">\(i=1,...,n\)</span>, obtain <span class="math inline">\(E[Y_i|A=a^*,M=m,L=L_{a^*,i},C=C_i]\)</span>, <span class="math inline">\(E[Y_i|A=a,M=m,L=L_{a,i},C=C_i]\)</span>, <span class="math inline">\(E[Y_i|A=a^*,M=G_{a^*,i},L=L_{a^*,i},C=C_i]\)</span>, <span class="math inline">\(E[Y_i|A=a^*,M=G_{a,i},L=L_{a^*,i},C=C_i]\)</span>, <span class="math inline">\(E[Y_i|A=a,M=G_{a^*,i},L=L_{a,i},C=C_i]\)</span> and <span class="math inline">\(E[Y_i|A=a,M=G_{a,i},L=L_{a,i},C=C_i]\)</span> from the regression model in step 5.</p></li>
<li>
<p>Impute the counterfactuals <span class="math inline">\(E[Y_{a^*m}]\)</span>, <span class="math inline">\(E[Y_{am}]\)</span>, <span class="math inline">\(E[Y_{a^*Ga^*}]\)</span>, <span class="math inline">\(E[Y_{aGa}]\)</span>, <span class="math inline">\(E[Y_{aGa^*}]\)</span> and <span class="math inline">\(E[Y_{a^*Ga}]\)</span>.</p>
<ul>
<li>Impute <span class="math inline">\(E[Y_{a^*m}]\)</span> by taking an average of <span class="math inline">\(\{E[Y_i|A=a^*,M=m,L=L_{a^*,i},C=C_i]\}_{i=1,...,n}\)</span>;</li>
<li>Impute <span class="math inline">\(E[Y_{am}]\)</span> by taking an average of <span class="math inline">\(\{E[Y_i|A=a,M=m,L=L_{a,i},C=C_i]\}_{i=1,...,n}\)</span>;</li>
<li>Impute <span class="math inline">\(E[Y_{a^*Ga^*}]\)</span> by taking an average of <span class="math inline">\(\{E[Y_i|A=a^*,M=G_{a^*,i},L=L_{a^*,i},C=C_i]\}_{i=1,...,n}\)</span>;</li>
<li>Impute <span class="math inline">\(E[Y_{aGa}]\)</span> by taking an average of <span class="math inline">\(\{E[Y_i|A=a,M=G_{a,i},L=L_{a,i},C=C_i]\}_{i=1,...,n}\)</span>;</li>
<li>Impute <span class="math inline">\(E[Y_{aGa^*}]\)</span> by taking an average of <span class="math inline">\(\{E[Y_i|A=a,M=G_{a^*,i},L=L_{a,i},C=C_i]\}_{i=1,...,n}\)</span>;</li>
<li>Impute <span class="math inline">\(E[Y_{a^*Ga}]\)</span> by taking an average of <span class="math inline">\(\{E[Y_i|A=a^*,M=G_{a,i},L=L_{a^*,i},C=C_i]\}_{i=1,...,n}\)</span>,</li>
</ul>
</li>
<li><p>Calculate causal effects with formulas in table 3 or table 4.</p></li>
</ol>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Baoyi Shi, <a href="https://scholar.harvard.edu/cchoirat">Christine Choirat</a>, <a href="https://www.lindavaleri.com/">Linda Valeri</a>.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
